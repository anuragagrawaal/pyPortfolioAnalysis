

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>pyPortfolioAnalysis package &mdash; pyPortfolioAnalysis  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="pyPortfolioAnalysis" href="modules.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> pyPortfolioAnalysis
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">pyPortfolioAnalysis</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">pyPortfolioAnalysis package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyportfolioanalysis-pyportfolioanalysis-module">pyPortfolioAnalysis.pyPortfolioAnalysis module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyPortfolioAnalysis">Module contents</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyportfolioanalysis-methods-to-optimize-portfolio">pyPortfolioAnalysis: Methods to optimize portfolio</a></li>
<li class="toctree-l4"><a class="reference internal" href="#optimization-methods">Optimization Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="#plots">Plots</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pyPortfolioAnalysis</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="modules.html">pyPortfolioAnalysis</a> &raquo;</li>
        
      <li>pyPortfolioAnalysis package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/pyPortfolioAnalysis.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="pyportfolioanalysis-package">
<h1>pyPortfolioAnalysis package<a class="headerlink" href="#pyportfolioanalysis-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="pyportfolioanalysis-pyportfolioanalysis-module">
<h2>pyPortfolioAnalysis.pyPortfolioAnalysis module<a class="headerlink" href="#pyportfolioanalysis-pyportfolioanalysis-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-pyPortfolioAnalysis">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pyPortfolioAnalysis" title="Permalink to this headline">¶</a></h2>
<div class="section" id="pyportfolioanalysis-methods-to-optimize-portfolio">
<h3>pyPortfolioAnalysis: Methods to optimize portfolio<a class="headerlink" href="#pyportfolioanalysis-methods-to-optimize-portfolio" title="Permalink to this headline">¶</a></h3>
<p>Documentation is available as docstring or as HTML on <a class="reference external" href="https://github.com/anuragagrawaal/pyPortfolioAnalysis">https://github.com/anuragagrawaal/pyPortfolioAnalysis</a></p>
<p>Fucntions and Classes</p>
</div>
<div class="section" id="optimization-methods">
<h3>Optimization Methods<a class="headerlink" href="#optimization-methods" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>‘HHI’
‘VaR’
‘VaR_portfolio’
‘add_constraint’
‘add_objective’
‘black_litterman’
‘box_constraint’
‘cVaR_portfolio’
‘constrained_objective’
‘diversification’
‘diversification_constraint’
‘equal_weight’
‘extract_groups’
‘extract_objective_measure’
‘extract_weights’
‘factor_exposure_constraint’
‘fn_map’
‘generate_sequence’
‘get_constraints’
‘group_constraint’
‘group_fail’
‘inverse_volatility_weights’
‘leverage_exposure_constraint’
‘leverage_fail’
‘max_sum_fail’
‘min_sum_fail’
‘minmax_objective’
‘normalize_weights’
‘optimize_portfolio’
‘performance_metrics_objective
‘port_mean’
‘portfolio_risk_objective’
‘portfolio_spec’
‘pos_limit_fail’
‘position_limit_constraint’
‘return_constraint’
‘return_objective’
‘risk_budget_objective’
‘rp_decrease’
‘rp_decrease_leverage’
‘rp_increase’
‘rp_position_limit’
‘rp_transform’
‘transaction_cost_constraint’
‘turnover’
‘turnover_constraint’
‘turnover_objective’
‘var_portfolio’
‘weight_concentration_objective’
‘weight_sum_constraint’</p>
</div></blockquote>
</div>
<div class="section" id="plots">
<h3>Plots<a class="headerlink" href="#plots" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>‘chart_efficient_frontier’
‘chart_group_weights’
‘chart_weights’</p>
</div></blockquote>
<div class="section" id="references">
<h4>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h4>
<p>Brian G. Peterson and Peter Carl (2018). PortfolioAnalytics: Portfolio Analysis, Including Numerical Methods for Optimization of Portfolios. R package version 1.1.0. <a class="reference external" href="https://CRAN.R-project.org/package=PortfolioAnalytics">https://CRAN.R-project.org/package=PortfolioAnalytics</a></p>
<p>Boudt, Kris and Lu, Wanbo and Peeters, Benedict, Higher Order Comoments of Multifactor Models and Asset Allocation (June 16, 2014). Available at SSRN: <a class="reference external" href="http://ssrn.com/abstract=2409603">http://ssrn.com/abstract=2409603</a> or <a class="reference external" href="http://dx.doi.org/10.2139/ssrn.2409603">http://dx.doi.org/10.2139/ssrn.2409603</a></p>
<p>Chriss, Neil A and Almgren, Robert, Portfolios from Sorts (April 27, 2005). Available at SSRN: <a class="reference external" href="http://ssrn.com/abstract=720041">http://ssrn.com/abstract=720041</a> or <a class="reference external" href="http://dx.doi.org/10.2139/ssrn.720041">http://dx.doi.org/10.2139/ssrn.720041</a></p>
<p>Meucci, Attilio, The Black-Litterman Approach: Original Model and Extensions (August 1, 2008). Shorter version in, THE ENCYCLOPEDIA OF QUANTITATIVE FINANCE, Wiley, 2010. Avail- able at SSRN: <a class="reference external" href="http://ssrn.com/abstract=1117574">http://ssrn.com/abstract=1117574</a> or <a class="reference external" href="http://dx.doi.org/10.2139/ssrn.1117574">http://dx.doi.org/10.2139/ssrn.1117574</a></p>
<p>Meucci, Attilio, Fully Flexible Views: Theory and Practice (August 8, 2008). Fully Flexible Views: Theory and Practice, Risk, Vol. 21, No. 10, pp. 97-102, October 2008. Available at SSRN: <a class="reference external" href="http://ssrn.com/abstract=1213325">http://ssrn.com/abstract=1213325</a></p>
<p>Scherer, Bernd and Martin, Doug, Modern Portfolio Optimization. Springer. 2005.</p>
<p>Shaw, William Thornton, Portfolio Optimization for VAR, CVaR, Omega and Utility with General Return Distributions: A Monte Carlo Approach for Long-Only and Bounded Short Portfolios with Optional Robustness and a Simplified Approach to Covariance Matching (June 1, 2011). Available at SSRN: <a class="reference external" href="http://ssrn.com/abstract=1856476">http://ssrn.com/abstract=1856476</a> or <a class="reference external" href="http://dx.doi.org/10.2139/ssrn.1856476">http://dx.doi.org/10.2139/ssrn.1856476</a></p>
<dl class="py function">
<dt id="pyPortfolioAnalysis.HHI">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">HHI</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">weights</span></em>, <em class="sig-param"><span class="n">groups</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.HHI" title="Permalink to this definition">¶</a></dt>
<dd><p>The Herfindahl Hirschman Index measures the concentration of weights using this function.</p>
<p>Concentration of weights</p>
<dl class="simple">
<dt>weights<span class="classifier">array-like,</span></dt><dd><p>collection of weights of the portfolio.</p>
</dd>
<dt>groups<span class="classifier">dict,</span></dt><dd><p>dictionary of groups.</p>
</dd>
</dl>
<p>returns the weight concentration given the weights</p>
<p>port_mean
var_portfolio
VaR
cVaR</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># calculate HHI</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.8</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">HHI</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.VaR">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">VaR</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">R</span></em>, <em class="sig-param"><span class="n">p</span><span class="o">=</span><span class="default_value">0.05</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.VaR" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the value at risk (VaR)</p>
<p>This function calculates the value at risk (VaR) assuming gaussian distribution</p>
<dl class="simple">
<dt>R<span class="classifier">pd.DataFrame object,</span></dt><dd><p>returns dataframe</p>
</dd>
<dt>p<span class="classifier">float, optional</span></dt><dd><p>quantile estimate</p>
</dd>
</dl>
<p>Calculates the VaR given returns</p>
<p>cVaR
VaR_portfolio</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">VaR</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">p</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.VaR_portfolio">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">VaR_portfolio</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">w</span></em>, <em class="sig-param"><span class="n">R</span></em>, <em class="sig-param"><span class="n">p</span><span class="o">=</span><span class="default_value">0.05</span></em>, <em class="sig-param"><span class="n">mean</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.VaR_portfolio" title="Permalink to this definition">¶</a></dt>
<dd><p>calculate the value at risk (VaR) of a portfolio</p>
<p>This function calculates the value at risk (VaR) assuming gaussian distribution</p>
<dl class="simple">
<dt>w<span class="classifier">array-like,</span></dt><dd><p>list of weights of portfolio</p>
</dd>
<dt>R<span class="classifier">pd.DataFrame object,</span></dt><dd><p>returns dataframe</p>
</dd>
<dt>p<span class="classifier">float, optional</span></dt><dd><p>quantile estimate</p>
</dd>
<dt>mean<span class="classifier">bool, default = True</span></dt><dd><p>mean VaR of portfolio</p>
</dd>
</dl>
<p>Calculates the VaR given portfolio weights</p>
<p>cVaR
VaR_portfolio
VaR</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">VaR_portfolio</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">p</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.add_constraint">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">add_constraint</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">portfolio</span></em>, <em class="sig-param"><span class="n">kind</span></em>, <em class="sig-param"><span class="n">enabled</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.add_constraint" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a constraint in portfolio_spec object</p>
<p>Main function to add or update constraint in portfolio_spec object</p>
<dl>
<dt>portfolio<span class="classifier">portfolio_spec,</span></dt><dd><p>an object of class portfolio_spec. see portfolio_spec</p>
</dd>
<dt>kind<span class="classifier">str,</span></dt><dd><blockquote>
<div><p>currently supported constraint: ’weight_sum’ (also ’leverage’ or ’weight’), ’box’, ’group’,</p>
</div></blockquote>
<dl class="simple">
<dt>’turnover’,’diversification’, ’position_limit’, ’return’, ’factor_exposure’,</dt><dd><p>or ’leverage_exposure’.</p>
</dd>
</dl>
</dd>
<dt>enabled<span class="classifier">bool, default = True</span></dt><dd><p>bool to enable or disable constraints.</p>
</dd>
<dt>kwargs<span class="classifier">additional key word arguments, optional</span></dt><dd><p>any additional constraint argument to be passed.</p>
</dd>
</dl>
<p>Adds constraints to object portfolio_spec of the specified input.</p>
<p>add_constraints
box_constraints
group_constraints
weight_sum_constraint
turnover_constraint
diversification_constraint
position_limit_constraint
return_constraint
factor_exposure_constraint
transaction_cost_constraint
leverage_exposure_constraint</p>
<p>•weight_sum, weight, leverage Specify constraint on the sum of the weights, see weight_sum_constraint    
•full_investment Special case to set min_sum=1 and max_sum=1 of weight sum constraints
•dollar_neutral, active Special case to set min_sum=0 and max_sum=0 of weight_sum constraints
•box box constraint for the individual asset weights, see box_constraint
•long_only Special case to set min=0 and max=1 of box constraint
•group specify the sum of weights within groups and the number of assets with non-zero weights in groups,</p>
<blockquote>
<div><p>see group_constraint</p>
</div></blockquote>
<dl class="simple">
<dt>•turnover Specify a constraint for target turnover. Turnover is calculated from a set of initial weights,</dt><dd><p>see turnover_constraint</p>
</dd>
</dl>
<p>•diversification target diversification of asset of weights, see diversification_constraint
•position_limit Specify the number of non-zero,long, and/orshortpositions, see position_limit_constraint
•return Specify the target mean return, see return_constraint
•factor_exposure Specify risk factor exposures, see factor_exposure_constraint
•leverage_exposure Specify a maximum leverage exposure, see leverage_exposure_constraint</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">portfolio</span> <span class="o">=</span> <span class="n">portfolio_spec</span><span class="p">(</span><span class="n">assets</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># adding weight_sum cinstraint</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="n">portfolio</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;weight_sum&#39;</span><span class="p">,</span> <span class="n">min_sum</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n">max_sum</span> <span class="o">=</span> <span class="o">.</span><span class="mi">95</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># long_only is a special kind of box constraint where minimum and maximum is positive</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># minimum and maximum can be list or scalars</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="n">portfolio</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;box&#39;</span><span class="p">,</span> <span class="n">minimum</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">maximum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="n">portfolio</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;long_only&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># group constraint is used to specify min and max weights of certain asset_groups</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># groups must be a dict and group_min and group_max can be scalar or list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="n">portfolio</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;group&#39;</span><span class="p">,</span> <span class="n">group_min</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">group_max</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="go">              groups = {&#39;eqity&#39;:[0,3], &#39;debt&#39;:[1,2]})</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># adding weight_sum constraint</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="n">portfolio</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;weight_sum&#39;</span><span class="p">,</span> <span class="n">min_sum</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n">max_sum</span> <span class="o">=</span> <span class="o">.</span><span class="mi">95</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># special case of weight_sum is dollar_neutral/active or full_investment</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="n">portfolio</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;dollar_neutral&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="n">portfolio</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;full_investment&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1">#turnover constraint</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="n">portfolio</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;turnover&#39;</span><span class="p">,</span> <span class="n">turnover_target</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1">#diversification constraint for diversification target in a portfolio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="n">portfolio</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;diversification&#39;</span><span class="p">,</span> <span class="n">div_target</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1">#position_limit is a constraint to restrict max position and also max long/short positions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="n">portfolio</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;position_limit&#39;</span><span class="p">,</span> <span class="n">max_pos</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">max_pos_long</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">max_pos_short</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1">#return constraint to add a target mean historical return to the portfolio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="n">portfolio</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;return&#39;</span><span class="p">,</span> <span class="n">return_target</span> <span class="o">=</span> <span class="mf">0.0018</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1">#adds a tranaction cost constraint on portfolio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="n">portfolio</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;transaction_cost&#39;</span><span class="p">,</span> <span class="n">ptc</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1">#constraint on the leverage of portfolio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="n">portfolio</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;leverage_exposure&#39;</span><span class="p">,</span> <span class="n">leverage</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1">#Factor_exposure constraint is used to test portfolio with their impact on certaint factors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># factors can be single or multiple with lower and upper limit. </span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># B can be a N*K matrix for N assets and K factors.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># lower and upper arguments can be float for single factor and list for multiple factors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="n">portfolio</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;factor_exposure&#39;</span><span class="p">,</span> 
<span class="go">              B = np.matrix([[1.2,1.3],</span>
<span class="go">                             [2.3,1.4],</span>
<span class="go">                             [1.4,0.9],</span>
<span class="go">                             [3.4,1.2]]),</span>
<span class="go">               lower = [0.8,1.4], upper = [2,2.4])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.add_objective">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">add_objective</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">portfolio</span></em>, <em class="sig-param"><span class="n">kind</span></em>, <em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">arguments</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">constraints</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">enabled</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">message</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.add_objective" title="Permalink to this definition">¶</a></dt>
<dd><p>This function is the primary function of adding and updating business goals in a portfolio.spec type object.
General interface, including risk, return, and risk budget, to add optimization goals.</p>
<dl class="simple">
<dt>portfolio<span class="classifier">portfolio_spec,</span></dt><dd><p>an object of class portfolio_spec.</p>
</dd>
<dt>kind<span class="classifier">str,</span></dt><dd><p>the character form of the goal to be added or changed, currently ‘return’,’ risk’,
‘risk_budget’,’ quadratic_utility’, or ‘weight_concentration’.</p>
</dd>
<dt>name<span class="classifier">str,</span></dt><dd><p>The target name should correspond to a feature, although we will attempt to make allowances
arguments : Default arguments to be transferred when executed on an objective function.</p>
</dd>
<dt>enabled<span class="classifier">bool, default = True</span></dt><dd><p>bool to enable or disable constraints.</p>
</dd>
<dt>message<span class="classifier">bool, default = True</span></dt><dd><p>bool to enable or disable messages.</p>
</dd>
<dt>kwargs<span class="classifier">additional key word arguments, optional</span></dt><dd><p>any additional constraint argument to be passed.</p>
</dd>
</dl>
<p>Adds objective to object portfolio_spec of the specified input.</p>
<p>add_objectives
portfolio_risk_objectives
risk_budget_objective
turnover_objective
minmax_objective
weight_constraint_objective</p>
<p>In general, you will define your objective as one of the following types:
’return’, ’risk’, ’risk_budget’, or ’weight_concentration’.</p>
<p>These have special handling and intelligent defaults for dealing with the function
most likely to be used as objectives, including mean, median, VaR, ES, etc.
Objectives of type ’turnover’ and ’minmax’ are also supported.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">port</span> <span class="o">=</span> <span class="n">portfolio_spec</span><span class="p">(</span><span class="n">assets</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas_datareader</span> <span class="k">as</span> <span class="nn">pdr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aapl</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;AAPL&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msft</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;MSFT&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tsla</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;TSLA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uber</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;UBER&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">amzn</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;AMZN&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">port</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;aapl&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">aapl</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">6</span><span class="p">],</span> <span class="s1">&#39;msft&#39;</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">msft</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">6</span><span class="p">],</span>
<span class="go">    &#39;tsla&#39;: pd.DataFrame.reset_index(tsla).iloc[:,6], &#39;uber&#39;:pd.DataFrame.reset_index(uber).iloc[:,6],</span>
<span class="go">    &#39;amzn&#39;: pd.DataFrame.reset_index(amzn).iloc[:,6]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">port_ret</span> <span class="o">=</span> <span class="n">port</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">R</span> <span class="o">=</span> <span class="n">port_ret</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="s1">&#39;long_only&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="s1">&#39;full_investment&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#adding objectives</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_objective</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;return&#39;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="mf">0.0018</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_objective</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;portfolio_risk&#39;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="mf">0.015</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_objective</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;risk_budget&#39;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;risk_budget&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_objective</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;weight_conc&#39;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;HHI&#39;</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="mf">0.11</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_objective</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;performance_metrics&#39;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;sharpe&#39;</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="mf">0.13</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># add a custom objective by first defining it.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">sortino_ratio</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">R</span><span class="p">):</span>
<span class="go">        #SOME CODE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_objective</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;performance_metrics&#39;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sortino&#39;</span><span class="p">:</span><span class="n">sortino_ratio</span><span class="p">},</span> <span class="n">target</span> <span class="o">=</span> <span class="mf">0.35</span><span class="p">)</span>
<span class="go">NOTE: The output of sortino_ratio or other custom function in objective must be a float.</span>
<span class="go">NOTE: you can also add other custom function in other kind of objective in similar methd.</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt id="pyPortfolioAnalysis.black_litterman">
<em class="property">class </em><code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">black_litterman</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">R</span></em>, <em class="sig-param"><span class="n">P</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.black_litterman" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class to call black_litterman object.</p>
<p>Black-litterman formula is popular to get posterior moments of the portfolio.</p>
<p>…</p>
<dl class="simple">
<dt>R<span class="classifier">pandas.DataFrame</span></dt><dd><p>dataframe of returns series.</p>
</dd>
<dt>P<span class="classifier">matrix-like,</span></dt><dd><p>KXN link matrix where N is the number of assets and K are the views</p>
</dd>
</dl>
<dl class="simple">
<dt>fit(Mu = None, S = None, Views = None, tau = 1):</dt><dd><p>returns a matrix of posterior returns based on Views and returns data.</p>
</dd>
</dl>
<dl class="py method">
<dt id="pyPortfolioAnalysis.black_litterman.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Mu</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">S</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Views</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tau</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.black_litterman.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>fit method of black_litterman object</p>
<p>Main function to call in order to return the posterior mean of the portfolio given the views and return.</p>
<dl class="simple">
<dt>Mu<span class="classifier">array-like, optional</span></dt><dd><p>prior mean of the returns. numpy.mean is called if Mu is None</p>
</dd>
<dt>S<span class="classifier">matrix-like, optional</span></dt><dd><p>NXN covariance matrix. numpy.cov is called if S is None</p>
</dd>
<dt>Views: array-like, default = None</dt><dd><p>array of K views held by investor.</p>
</dd>
<dt>Tau: float, default = 1</dt><dd><p>multiplying factor to be used.</p>
</dd>
</dl>
<dl class="simple">
<dt>array:</dt><dd><p>returns an array of posterior moments of portfolio given the returns and weights</p>
</dd>
</dl>
<p>portfolio_spec
optimize_portfolio</p>
<p>Black-litterman formula is very useful if an investor believes that a particular stock is going to rise
compared to others although this information is not incorporated in the stock price. Essentially, it captures
the views an investor holds for a particular asset.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas_datareader</span> <span class="k">as</span> <span class="nn">pdr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aapl</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;AAPL&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msft</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;MSFT&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tsla</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;TSLA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">port</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;aapl&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">aapl</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">6</span><span class="p">],</span> <span class="s1">&#39;msft&#39;</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">msft</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">6</span><span class="p">],</span>
<span class="go">                   &#39;tsla&#39;: pd.DataFrame.reset_index(tsla).iloc[:,6]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">port_ret</span> <span class="o">=</span> <span class="n">port</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Views</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">([[</span><span class="mf">0.02</span><span class="p">],</span>
<span class="go">               [0.05]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bl</span> <span class="o">=</span> <span class="n">black_litterman</span><span class="p">(</span><span class="n">R</span> <span class="o">=</span> <span class="n">port_ret</span><span class="p">,</span> <span class="n">P</span> <span class="o">=</span> <span class="n">P</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Views</span> <span class="o">=</span> <span class="n">Views</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.box_constraint">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">box_constraint</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">assets</span></em>, <em class="sig-param"><span class="n">minimum</span></em>, <em class="sig-param"><span class="n">maximum</span></em>, <em class="sig-param"><span class="n">kind</span><span class="o">=</span><span class="default_value">'box'</span></em>, <em class="sig-param"><span class="n">enabled</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">message</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.box_constraint" title="Permalink to this definition">¶</a></dt>
<dd><p>The box constraint defines the upper and lower limits of asset weights.
add_constraint calls this function when type=”box” is defined.</p>
<dl class="simple">
<dt>assets<span class="classifier">int, or array-like,</span></dt><dd><p>number of assets, or optionally a named list of assets specifying initial weights.</p>
</dd>
<dt>minimum<span class="classifier">float, or array-like,</span></dt><dd><p>numeric or named list defining the minimum constraints of the weight box.</p>
</dd>
<dt>maximum<span class="classifier">float, or array-like,</span></dt><dd><p>numeric or named list defining the maximum constraints of the weight box.</p>
</dd>
<dt>kind<span class="classifier">str,</span></dt><dd><p>string of kind of constraint.</p>
</dd>
<dt>enabled<span class="classifier">bool, default = True</span></dt><dd><p>bool to enable or disable constraints.</p>
</dd>
<dt>message<span class="classifier">bool, default = True</span></dt><dd><p>bool to enable or disable messages.</p>
</dd>
<dt>kwargs<span class="classifier">additional key word arguments, optional</span></dt><dd><p>any additional constraint argument to be passed.</p>
</dd>
</dl>
<p>Add box constraints to object portfolio_spec of the specified input.</p>
<p>add_constraints
box_constraints
group_constraints
weight_sum_constraint
turnover_constraint
diversification_constraint
position_limit_constraint
return_constraint
factor_exposure_constraint
transaction_cost_constraint
leverage_exposure_constraint</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="n">portfolio</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;box&#39;</span><span class="p">,</span> <span class="n">minimum</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">maximum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.cVaR_portfolio">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">cVaR_portfolio</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">w</span></em>, <em class="sig-param"><span class="n">R</span></em>, <em class="sig-param"><span class="n">p</span><span class="o">=</span><span class="default_value">0.05</span></em>, <em class="sig-param"><span class="n">mean</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.cVaR_portfolio" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the conditional value at risk (cVaR) of a portfolio</p>
<p>This function calculates the conditional value at risk (cVaR) assuming gaussian distribution</p>
<dl class="simple">
<dt>w<span class="classifier">array-like,</span></dt><dd><p>list of weights of portfolio</p>
</dd>
<dt>R<span class="classifier">pd.DataFrame object,</span></dt><dd><p>returns dataframe</p>
</dd>
<dt>p<span class="classifier">float, optional</span></dt><dd><p>quantile estimate</p>
</dd>
<dt>mean<span class="classifier">bool, default = True</span></dt><dd><p>mean VaR of portfolio</p>
</dd>
</dl>
<p>Calculates the VaR given portfolio weights</p>
<p>cVaR
VaR_portfolio
VaR</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cVaR_portfolio</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">p</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.chart_efficient_frontier">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">chart_efficient_frontier</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">portfolio</span></em>, <em class="sig-param"><span class="n">R</span></em>, <em class="sig-param"><span class="n">metric</span><span class="o">=</span><span class="default_value">'Sharpe Ratio'</span></em>, <em class="sig-param"><span class="n">arguments</span><span class="o">=</span><span class="default_value">{'rf': 0.0}</span></em>, <em class="sig-param"><span class="n">cml</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">rand_pf</span><span class="o">=</span><span class="default_value">300</span></em>, <em class="sig-param"><span class="n">optimize_method</span><span class="o">=</span><span class="default_value">'DEoptim'</span></em>, <em class="sig-param"><span class="n">alpha</span><span class="o">=</span><span class="default_value">0.4</span></em>, <em class="sig-param"><span class="n">figsize</span><span class="o">=</span><span class="default_value">(10, 6)</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.chart_efficient_frontier" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to plot efficient frontier of portfolio.</p>
<dl class="simple">
<dt>portfolio<span class="classifier">portfolio_spec,</span></dt><dd><p>an object of class portfolio_spec.</p>
</dd>
<dt>R<span class="classifier">pandas dataframe,</span></dt><dd><p>dataframe of the returns series</p>
</dd>
<dt>metric: str, default = ‘Sharpe Ratio’</dt><dd><p>metric should be either of ‘Sharpe Ratio’ or ‘Treynor Ratio’</p>
</dd>
<dt>arguments<span class="classifier">dict, optional</span></dt><dd><p>additional arguments such as risk-free rate in the form of a dictionary.</p>
</dd>
<dt>cml<span class="classifier">bool, default = False</span></dt><dd><p>bool to enable or disable capital market line</p>
</dd>
<dt>rand_pf<span class="classifier">int, optional</span></dt><dd><p>random portfolio to plot to show the efficient frontier</p>
</dd>
<dt>optimize_method<span class="classifier">str, optional</span></dt><dd><p>optimize_method should be similar to those in optimize_portfolio. see optimize_portfolio</p>
</dd>
<dt>alpha<span class="classifier">float, optional</span></dt><dd><p>transparency</p>
</dd>
<dt>figsize<span class="classifier">tuple, optional</span></dt><dd><p>figure size in the form of a tuple</p>
</dd>
<dt>kwargs<span class="classifier">additional key word arguments, optional</span></dt><dd><p>any additional constraint argument to be passed.</p>
</dd>
</dl>
<p>matplotlib.scatter</p>
<p>chart_group_weights
chart_weights
chart_efficient_frontier</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Rb is S&amp;P500 benchmark for capital market line and beta for treynor ratio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chart_efficient_froniter</span><span class="p">(</span><span class="n">portfolio</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">metric</span> <span class="o">=</span> <span class="s1">&#39;Treynor Ratio&#39;</span><span class="p">,</span> 
<span class="go">    arguments = {&#39;rf&#39;: 0.0008, &#39;Rb&#39;:Rb}, cml = True, alpha = 0.1, rand_pf = 1000, optimize_method = &#39;pso&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.chart_group_weights">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">chart_group_weights</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">portfolio</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.chart_group_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to plot individual group weights of optimal weights.</p>
<dl class="simple">
<dt>portfolio<span class="classifier">portfolio_spec,</span></dt><dd><p>an object of class portfolio_spec.</p>
</dd>
</dl>
<p>matplotlib.lines.Line2D</p>
<p>chart_group_weights
chart_efficient_frontier</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">chart_group_weights</span><span class="p">(</span><span class="n">portfolio</span><span class="p">)</span>
<span class="go">NOTE: chart_group_weights will only work after call optimize_portfolio on portfolio_spec</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.chart_weights">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">chart_weights</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">portfolio</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.chart_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to plot weights of optimal weights.</p>
<dl class="simple">
<dt>portfolio<span class="classifier">portfolio_spec,</span></dt><dd><p>an object of class portfolio_spec.</p>
</dd>
</dl>
<p>matplotlib.lines.Line2D</p>
<p>chart_group_weights
chart_efficient_frontier</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">chart_weights</span><span class="p">(</span><span class="n">portfolio</span><span class="p">)</span>
<span class="go">NOTE: chart_group_weights will only work after call optimize_portfolio on portfolio_spec</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.constrained_objective">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">constrained_objective</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">w</span></em>, <em class="sig-param"><span class="n">R</span></em>, <em class="sig-param"><span class="n">portfolio</span></em>, <em class="sig-param"><span class="n">trace</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">normalize</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">storage</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">penalty</span><span class="o">=</span><span class="default_value">10000</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">kwargs</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">args</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.constrained_objective" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a constraint in portfolio_spec object</p>
<p>Main function to add or update constraint in portfolio_spec object</p>
<dl class="simple">
<dt>w<span class="classifier">array-like,</span></dt><dd><p>weights to test</p>
</dd>
<dt>R<span class="classifier">pd.DataFrame,</span></dt><dd><p>dataframe of returns of assets in portfolio</p>
</dd>
<dt>trace<span class="classifier">bool, default = False</span></dt><dd><p>bool to enable or disable constraints.</p>
</dd>
<dt>normalize<span class="classifier">bool, default = False</span></dt><dd><p>bool to specify if weights should be normalized first. see normalize_weights.</p>
</dd>
<dt>verbose<span class="classifier">bool, default = False</span></dt><dd><p>bool to enable or disable verbose argument.</p>
</dd>
<dt>penalty<span class="classifier">int, optional</span></dt><dd><p>int value specifying he penalty if constraint or objective is breached.</p>
</dd>
<dt>kwargs<span class="classifier">additional key word arguments, optional</span></dt><dd><p>any additional constraint argument to be passed.</p>
</dd>
<dt>kwargs<span class="classifier">additional arguments, optional</span></dt><dd><p>any additional argument to be passed.</p>
</dd>
</dl>
<p>returns a float of total penalty given a weight. if trace = True, additional objective measure will be returned
in the form of dictionary.</p>
<p>rp_transform
optimize_portfolio</p>
<p>constrained_objective is the main function that is called by 
optimize_weights to optimze the constraint and objectives provided by the portfolio.</p>
<p>Loosely speaking, constrained_objective is very similar to an information criteria.</p>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.diversification">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">diversification</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">weights</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.diversification" title="Permalink to this definition">¶</a></dt>
<dd><p>Diversification is stated as 1 minus the total of the squared weights</p>
<p>Diversification function to compute as a constraint</p>
<dl class="simple">
<dt>weights<span class="classifier">array-like,</span></dt><dd><p>list of weights of assets.</p>
</dd>
</dl>
<p>returns diversification given the weights</p>
<p>turnover</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">turnover</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.diversification_constraint">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">diversification_constraint</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">assets</span></em>, <em class="sig-param"><span class="n">div_target</span></em>, <em class="sig-param"><span class="n">kind</span><span class="o">=</span><span class="default_value">'diversification'</span></em>, <em class="sig-param"><span class="n">enabled</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">message</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.diversification_constraint" title="Permalink to this definition">¶</a></dt>
<dd><p>Target diversification value is specified under the diversification constraint.</p>
<p>This function is called by add.constraint when type=”diversification” is mentioned.</p>
<dl class="simple">
<dt>assets<span class="classifier">Int, or array-like,</span></dt><dd><p>Number of assets or, as an alternative, a named asset list specifying initial weights.</p>
</dd>
<dt>div_target<span class="classifier">float,</span></dt><dd><p>diversification target value</p>
</dd>
<dt>kind<span class="classifier">str,</span></dt><dd><p>string of the kind of constraint.</p>
</dd>
<dt>enabled<span class="classifier">bool, default = True</span></dt><dd><p>bool to enable or disable constraints.</p>
</dd>
<dt>message<span class="classifier">bool, default = True</span></dt><dd><p>bool to enable or disable messages.</p>
</dd>
</dl>
<p>Adds diversification constraints to object portfolio_spec of the specified input.</p>
<p>add_constraints
box_constraints
group_constraints
weight_sum_constraint
turnover_constraint
diversification_constraint
position_limit_constraint
return_constraint
factor_exposure_constraint
transaction_cost_constraint
leverage_exposure_constraint</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1">#diversification constraint for diversification target in a portfolio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="n">portfolio</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;diversification&#39;</span><span class="p">,</span> <span class="n">div_target</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.equal_weight">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">equal_weight</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">R</span></em>, <em class="sig-param"><span class="n">portfoio</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.equal_weight" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to extract objective measures of equal weight portfolio.</p>
<dl class="simple">
<dt>R<span class="classifier">pd.DataFrame,</span></dt><dd><p>dataframe of returns of assets in portfolio</p>
</dd>
<dt>portfolio<span class="classifier">portfolio_spec,</span></dt><dd><p>an object of class portfolio_spec.</p>
</dd>
<dt>kwargs<span class="classifier">additional arguments, optional</span></dt><dd><p>any additional argument to be passed.</p>
</dd>
</dl>
<p>dictionary of objective measures of equal weighted portfolio</p>
<p>inverse_volatility_weights</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">equal_weight</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">portfolio</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.extract_groups">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">extract_groups</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">portfolio</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.extract_groups" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to extract groups from portfolio_spec object.</p>
<dl class="simple">
<dt>portfolio<span class="classifier">portfolio_spec,</span></dt><dd><p>an object of class portfolio_spec.</p>
</dd>
</dl>
<p>dictionary of groups if group_constraint is specified.</p>
<p>extract_weights
extract_objective_measure
extract_groups</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">extract_groups</span><span class="p">(</span><span class="n">portfolio</span><span class="p">)</span>
<span class="go">NOTE: extract_groups will only work after calling optimize_portfolio on portfolio_spec</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.extract_objective_measure">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">extract_objective_measure</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">R</span></em>, <em class="sig-param"><span class="n">portfolio</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.extract_objective_measure" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to extract objective measures of optimal weights.</p>
<dl class="simple">
<dt>R<span class="classifier">pd.DataFrame,</span></dt><dd><p>dataframe of returns of assets in portfolio</p>
</dd>
<dt>portfolio<span class="classifier">portfolio_spec,</span></dt><dd><p>an object of class portfolio_spec.</p>
</dd>
<dt>kwargs<span class="classifier">additional arguments, optional</span></dt><dd><p>any additional argument to be passed.</p>
</dd>
</dl>
<p>dictionary of objective measures as specified in the portfolio_spec object</p>
<p>extract_weights
extract_objective_measure
extract_groups</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">extract_objective_measure</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">portfolio</span><span class="p">)</span>
<span class="go">NOTE: extract_objective_measure will only work after calling optimize_portfolio on portfolio_spec</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.extract_weights">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">extract_weights</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">portfolio</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.extract_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to extract optimal weights.</p>
<dl class="simple">
<dt>portfolio<span class="classifier">portfolio_spec,</span></dt><dd><p>an object of class portfolio_spec.</p>
</dd>
</dl>
<p>array of optimal weights</p>
<p>extract_objective_measure
extract_groups</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">extract_weights</span><span class="p">(</span><span class="n">portfolio</span><span class="p">)</span>
<span class="go">NOTE: extract_weights will only work after calling optimize_portfolio on portfolio_spec</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.factor_exposure_constraint">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">factor_exposure_constraint</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">assets</span></em>, <em class="sig-param"><span class="n">B</span></em>, <em class="sig-param"><span class="n">lower</span></em>, <em class="sig-param"><span class="n">upper</span></em>, <em class="sig-param"><span class="n">kind</span><span class="o">=</span><span class="default_value">'factor_exposure'</span></em>, <em class="sig-param"><span class="n">enabled</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">message</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.factor_exposure_constraint" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a factor exposure constraint for “K” different factos in a portdolio and also their exposure to 
particular asset.</p>
<dl class="simple">
<dt>assets<span class="classifier">int, or array-like,</span></dt><dd><p>named list of assets specifying initial weights.</p>
</dd>
<dt>B<span class="classifier">matrix-like,</span></dt><dd><p>matrix or list of risk factor exposures</p>
</dd>
<dt>lower<span class="classifier">int, or array-like</span></dt><dd><p>list of lower limits of risk factor exposure constraints.</p>
</dd>
<dt>upper<span class="classifier">int, or array-like</span></dt><dd><p>list of upper limits of risk factor exposure constraints.</p>
</dd>
<dt>kind<span class="classifier">str,</span></dt><dd><p>string of kind of constraints.</p>
</dd>
<dt>enabled<span class="classifier">bool, default = True</span></dt><dd><p>bool to enable or disable constraints.</p>
</dd>
<dt>message<span class="classifier">bool, default = False</span></dt><dd><p>bool to enable or disable messages.</p>
</dd>
</dl>
<p>Adds factor_exposure constraints to object portfolio_spec of the specified input.</p>
<p>add_constraints
box_constraints
group_constraints
weight_sum_constraint
turnover_constraint
diversification_constraint
position_limit_constraint
return_constraint
factor_exposure_constraint
transaction_cost_constraint
leverage_exposure_constraint</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1">#Factor_exposure constraint is used to test portfolio with their impact on certaint factors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># factors can be single or multiple with lower and upper limit. </span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># B can be a N*K matrix for N assets and K factors.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># lower and upper arguments can be float for single factor and list for multiple factors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="n">portfolio</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;factor_exposure&#39;</span><span class="p">,</span> 
<span class="go">              B = np.matrix([[1.2,1.3],</span>
<span class="go">                             [2.3,1.4],</span>
<span class="go">                             [1.4,0.9],</span>
<span class="go">                             [3.4,1.2]]),</span>
<span class="go">               lower = [0.8,1.4], upper = [2,2.4])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.fn_map">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">fn_map</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">weights</span></em>, <em class="sig-param"><span class="n">portfolio</span></em>, <em class="sig-param"><span class="n">relax</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.fn_map" title="Permalink to this definition">¶</a></dt>
<dd><p>This function transforms list of weights that does not meet the portfolio constraints to an array that meets
the constraints. relax argument (default = False) if True gives the function permission to transform weights 
if needed</p>
<dl class="simple">
<dt>weights<span class="classifier">array-like,</span></dt><dd><p>list of initial weights.</p>
</dd>
<dt>portfolio<span class="classifier">portfolio_spec,</span></dt><dd><p>an object of class portfolio_spec.</p>
</dd>
<dt>relax<span class="classifier">bool, default = False</span></dt><dd><p>bool to enable or disable constraints.</p>
</dd>
<dt>verbose<span class="classifier">bool, default = False</span></dt><dd><p>bool to enable or disable messages.</p>
</dd>
</dl>
<p>returns the array of weights tranformed by the function and that does satisfy the constraints.
called by optimize_portfolio if optimize_method = ‘DEoptim’ or ‘pso’</p>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.generate_sequence">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">generate_sequence</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">minimum</span><span class="o">=</span><span class="default_value">0.01</span></em>, <em class="sig-param"><span class="n">maximum</span><span class="o">=</span><span class="default_value">1.01</span></em>, <em class="sig-param"><span class="n">by</span><span class="o">=</span><span class="default_value">0.01</span></em>, <em class="sig-param"><span class="n">rounding</span><span class="o">=</span><span class="default_value">3</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.generate_sequence" title="Permalink to this definition">¶</a></dt>
<dd><p>The sequence of min&lt;-&gt;max weights for random.</p>
<p>Creating a series of potential weights for portfolios of random or brute force.</p>
<dl class="simple">
<dt>minimum<span class="classifier">float,</span></dt><dd><p>sequence minimum value</p>
</dd>
<dt>maximum<span class="classifier">float,</span></dt><dd><p>sequence maximum value</p>
</dd>
<dt>by<span class="classifier">float, optional</span></dt><dd><p>number to increase the series by</p>
</dd>
<dt>rounding<span class="classifier">int, optional</span></dt><dd><p>integer the number of decimals we can round to</p>
</dd>
</dl>
<p>returns a series of ranfom weights that satisfy the min-max weights constraint. 
Default weight_seq for rp_transform</p>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.get_constraints">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">get_constraints</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">portfolio</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.get_constraints" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper functionality to get the constraints allowed out of the portfolio object</p>
<dl class="simple">
<dt>portfolio<span class="classifier">portfolio_spec,</span></dt><dd><p>an object of class portfolio_spec.</p>
</dd>
</dl>
<p>returns dictionary of constraints extracted from the portfolio_spec object</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">port</span> <span class="o">=</span> <span class="n">portfolio_spec</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="s1">&#39;dollar_neutral&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_constraint</span><span class="p">(</span><span class="n">port</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.group_constraint">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">group_constraint</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">assets</span></em>, <em class="sig-param"><span class="n">groups</span></em>, <em class="sig-param"><span class="n">group_min</span></em>, <em class="sig-param"><span class="n">group_max</span></em>, <em class="sig-param"><span class="n">kind</span><span class="o">=</span><span class="default_value">'group'</span></em>, <em class="sig-param"><span class="n">enabled</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">message</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.group_constraint" title="Permalink to this definition">¶</a></dt>
<dd><p>Group constraints determine the grouping of assets, group weights,
and the number of positions of the groups (i.e. non-zero weights).</p>
<dl class="simple">
<dt>assets<span class="classifier">Int, or array-like,</span></dt><dd><p>Number of assets or, as an alternative, a named asset list specifying initial weights.</p>
</dd>
<dt>groups<span class="classifier">Dict, </span></dt><dd><p>dictionary specifying the assets groups.</p>
</dd>
<dt>group_min<span class="classifier">float, or array-like,</span></dt><dd><p>numeric or named list defining the minimum constraints of the weight group.</p>
</dd>
<dt>group_max<span class="classifier">float, or array-like,</span></dt><dd><p>numeric or named list defining the maximum constraints of the weight group.</p>
</dd>
<dt>kind<span class="classifier">str,</span></dt><dd><p>string of kind of constraint.</p>
</dd>
<dt>enabled<span class="classifier">bool, default = True</span></dt><dd><p>bool to enable or disable constraints.</p>
</dd>
<dt>message<span class="classifier">bool, default = False</span></dt><dd><p>bool to enable or disable messages.</p>
</dd>
</dl>
<p>Adds group constraints to object portfolio_spec of the specified input.</p>
<p>add_constraints
box_constraints
group_constraints
weight_sum_constraint
turnover_constraint
diversification_constraint
position_limit_constraint
return_constraint
factor_exposure_constraint
transaction_cost_constraint
leverage_exposure_constraint</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="n">portfolio</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;group&#39;</span><span class="p">,</span> <span class="n">group_min</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> 
<span class="go">    group_max =1, groups = {&#39;eqity&#39;:[0,3], &#39;debt&#39;:[1,2]})</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.group_fail">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">group_fail</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">weights</span></em>, <em class="sig-param"><span class="n">groups</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cLO</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cUP</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">group_pos</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.group_fail" title="Permalink to this definition">¶</a></dt>
<dd><p>The role loops through each group and checks if the cLO or cUP for the given group has been breached.
This is a rp_transform helper feature.
Test if group limits have been breached.</p>
<dl class="simple">
<dt>weights<span class="classifier">array-like,</span></dt><dd><p>test the list of weights</p>
</dd>
<dt>groups<span class="classifier">dict,</span></dt><dd><p>A dictionary defining the asset classes. similar in group_constraint.</p>
</dd>
<dt>cLO<span class="classifier">float, or array-like,</span></dt><dd><p>Specifying minimum weight group constraints by numeric or vector.</p>
</dd>
<dt>cUP<span class="classifier">float, or array-like,</span></dt><dd><p>Specifying maximum weight group constraints by numeric or vector.</p>
</dd>
<dt>group_pos<span class="classifier">array-like, optional</span></dt><dd><p>A list that defines the number of non-zero weights for each category.</p>
</dd>
</dl>
<p>Bool returning “True” if group weights are breached</p>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.inverse_volatility_weights">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">inverse_volatility_weights</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">R</span></em>, <em class="sig-param"><span class="n">portfoio</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.inverse_volatility_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to calculate objective_measure of inverse volatility portfolio</p>
<dl class="simple">
<dt>R<span class="classifier">pd.DataFrame,</span></dt><dd><p>dataframe of returns of assets in portfolio</p>
</dd>
<dt>portfolio<span class="classifier">portfolio_spec,</span></dt><dd><p>an object of class portfolio_spec.</p>
</dd>
<dt>kwargs<span class="classifier">additional arguments, optional</span></dt><dd><p>any additional argument to be passed.</p>
</dd>
</dl>
<p>dictionary of objective measures of inverse volatility portfolio</p>
<p>equal_weight
inverse_volatility_weight</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">inverse_volatility_weight</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">portfolio</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.leverage_exposure_constraint">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">leverage_exposure_constraint</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">assets</span></em>, <em class="sig-param"><span class="n">leverage</span></em>, <em class="sig-param"><span class="n">kind</span><span class="o">=</span><span class="default_value">'leverage_exposure'</span></em>, <em class="sig-param"><span class="n">enabled</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">message</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.leverage_exposure_constraint" title="Permalink to this definition">¶</a></dt>
<dd><p>A maximum leverage where leverage is stated as the total of the absolute value of the weights
is determined under the leverage_exposure constraint.</p>
<dl class="simple">
<dt>assets<span class="classifier">int, or array-like,</span></dt><dd><p>leverage : maximum leverage value</p>
</dd>
<dt>kind<span class="classifier">str,</span></dt><dd><p>string of kind of constraints</p>
</dd>
<dt>enabled<span class="classifier">bool, default = True</span></dt><dd><p>bool to enable or disable constraints.</p>
</dd>
<dt>message<span class="classifier">bool, default = True</span></dt><dd><p>bool to enable or disable messages.</p>
</dd>
</dl>
<p>Adds leverage_exposure constraints to object portfolio_spec of the specified input.</p>
<p>add_constraints
box_constraints
group_constraints
weight_sum_constraint
turnover_constraint
diversification_constraint
position_limit_constraint
return_constraint
factor_exposure_constraint
transaction_cost_constraint
leverage_exposure_constraint</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1">#constraint on the leverage of portfolio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="n">portfolio</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;leverage_exposure&#39;</span><span class="p">,</span> <span class="n">leverage</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.leverage_fail">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">leverage_fail</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">weights</span></em>, <em class="sig-param"><span class="n">leverage</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.leverage_fail" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>It is used by rp_transform as a helper function to test if leverage constraint is breached.</p>
<dl class="simple">
<dt>weights<span class="classifier">array-like,</span></dt><dd><p>test the list of weights.</p>
</dd>
<dt>leverage<span class="classifier">float,</span></dt><dd><p>specify the leverage the portfolio must satisfy</p>
</dd>
</dl>
<p>Returns “True” if the weights fail the leverage_exposure constraint. Called by rp_transform. see rp_transform.</p>
<dl class="simple">
<dt>pos_limit_fail</dt><dd><p>import numpy as np</p>
</dd>
</dl>
<p>import pandas as pd</p>
</div></blockquote>
<p>rp_transform</p>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.max_sum_fail">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">max_sum_fail</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">weights</span></em>, <em class="sig-param"><span class="n">max_sum</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.max_sum_fail" title="Permalink to this definition">¶</a></dt>
<dd><p>it is used by rp_transform as a helper function to test if max_sum constraint is breached.</p>
<dl class="simple">
<dt>weights<span class="classifier">array-like,</span></dt><dd><p>test the list of weights</p>
</dd>
<dt>max_sum<span class="classifier">float, optional</span></dt><dd><p>max_sum of the weights of portfolio</p>
</dd>
</dl>
<p>Returns “True” if the weights fail the max_sum constraint. Called by rp_transform. see rp_transform.</p>
<p>fn_map, rp_transform</p>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.min_sum_fail">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">min_sum_fail</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">weights</span></em>, <em class="sig-param"><span class="n">min_sum</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.min_sum_fail" title="Permalink to this definition">¶</a></dt>
<dd><p>it is used by rp_transform as a helper function to test if min_sum constraint is breached.</p>
<dl class="simple">
<dt>weights<span class="classifier">array-like,</span></dt><dd><p>test the list of weights</p>
</dd>
<dt>min_sum<span class="classifier">float, optional</span></dt><dd><p>max_sum of the weights of portfolio</p>
</dd>
</dl>
<p>Returns “True” if the weights fail the min_sum constraint. Called by rp_transform. see rp_transform.</p>
<p>fn_map, rp_transform</p>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.minmax_objective">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">minmax_objective</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">minimum</span></em>, <em class="sig-param"><span class="n">maximum</span></em>, <em class="sig-param"><span class="n">multiplier</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">arguments</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">target</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">enabled</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.minmax_objective" title="Permalink to this definition">¶</a></dt>
<dd><p>This target allows to determine min and max goals.
Constructor for the tmp_minmax_objective.</p>
<dl class="simple">
<dt>name<span class="classifier">str,</span></dt><dd><p>The target name should correspond to a feature, although we will attempt to make allowances.</p>
</dd>
<dt>minimum<span class="classifier">float,</span></dt><dd><p>minimum value</p>
</dd>
<dt>maximum<span class="classifier">float,</span></dt><dd><p>maximum value</p>
</dd>
<dt>multiplier<span class="classifier">int, optional</span></dt><dd><p>Multiplier to be added to the target, typically 1 or -1.</p>
</dd>
<dt>arguments<span class="classifier">dict,</span></dt><dd><p>Default arguments to be transferred when executed on an objective function.</p>
</dd>
<dt>target<span class="classifier">float,</span></dt><dd><p>Univariate goal for the target.</p>
</dd>
<dt>enabled<span class="classifier">bool, default = True</span></dt><dd><p>bool to enable or disable constraints.</p>
</dd>
</dl>
<p>Adds minmax_objective to object portfolio_spec of the specified input.</p>
<p>add_objectives
portfolio_risk_objectives
risk_budget_objective
turnover_objective
minmax_objective
weight_constraint_objective</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">port</span> <span class="o">=</span> <span class="n">portfolio_spec</span><span class="p">(</span><span class="n">assets</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas_datareader</span> <span class="k">as</span> <span class="nn">pdr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aapl</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;AAPL&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msft</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;MSFT&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tsla</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;TSLA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uber</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;UBER&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">amzn</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;AMZN&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">port</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;aapl&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">aapl</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">6</span><span class="p">],</span> <span class="s1">&#39;msft&#39;</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">msft</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">6</span><span class="p">],</span>
<span class="go">    &#39;tsla&#39;: pd.DataFrame.reset_index(tsla).iloc[:,6], &#39;uber&#39;:pd.DataFrame.reset_index(uber).iloc[:,6],</span>
<span class="go">    &#39;amzn&#39;: pd.DataFrame.reset_index(amzn).iloc[:,6]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">port_ret</span> <span class="o">=</span> <span class="n">port</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">R</span> <span class="o">=</span> <span class="n">port_ret</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="s1">&#39;long_only&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="s1">&#39;full_investment&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#adding objectives</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_objective</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;risk&#39;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="mf">0.015</span><span class="p">)</span>
<span class="go">NOTE: you can add other custom function in other kind of objective in similar methd. See add_objective</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.normalize_weights">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">normalize_weights</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">weights</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.normalize_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a constraint in portfolio_spec object</p>
<p>Main function to add or update constraint in portfolio_spec object</p>
<dl class="simple">
<dt>weights<span class="classifier">array-like,</span></dt><dd><p>list of weights to normalize based on constraints.</p>
</dd>
</dl>
<p>Returns array of normalized weights. Called be optimize_portfolio when optimize_method is:
‘pso’, ‘dual_annealing’, ‘shgo’, ‘basinhopping’, ‘brute’.</p>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.optimize_portfolio">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">optimize_portfolio</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">R</span></em>, <em class="sig-param"><span class="n">portfolio</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">constraints</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">objectives</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">optimize_method</span><span class="o">=</span><span class="default_value">['pso', 'DEoptim', 'dual_annealing', 'brute', 'shgo', 'basinhopping', 'best']</span></em>, <em class="sig-param"><span class="n">search_size</span><span class="o">=</span><span class="default_value">20000</span></em>, <em class="sig-param"><span class="n">trace</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">message</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.optimize_portfolio" title="Permalink to this definition">¶</a></dt>
<dd><p>This function is calls the portfolio to optimize the weights given the constrained and objectives of portfolio
provided using add_constraint and add_objective functions.</p>
<p>Main function to optimize portfolio weights given the constraints and objectives</p>
<dl>
<dt>R<span class="classifier">pandas dataframe,</span></dt><dd><p>dataframe of the series of returns</p>
</dd>
<dt>portfolio<span class="classifier">portfolio_spec,</span></dt><dd><p>an object of class portfolio_spec.</p>
</dd>
<dt>constraints<span class="classifier">dict, optional</span></dt><dd><p>constraints to be minimized/maximized given the assets. 
Although they are automatically called if portfolio_spec object has constraints specified</p>
</dd>
<dt>objectives<span class="classifier">dict, optional</span></dt><dd><p>objectives to be minimized/maximized given the assets. 
Although they are automatically called if portfolio_spec object has objectives specified</p>
</dd>
<dt>optimize_method<span class="classifier">float,</span></dt><dd><p>the method for optimizing portfolio. currently supported methods are:
‘pso’
‘DEoptim’
‘dual_annealing’
‘brute’
‘shgo’
‘basinhopping’</p>
<p>User can also specify ‘best’ as optimize_method to use all optimizer and choose the best among them.</p>
</dd>
<dt>search_size: int, optional</dt><dd><p>specify th iterations to do before calling the best portfolio</p>
</dd>
<dt>trace<span class="classifier">bool, default = False</span></dt><dd><p>bool to enable or disable trace of portfolio.</p>
</dd>
<dt>message<span class="classifier">bool, default = False</span></dt><dd><p>bool to enable or disable messages.</p>
</dd>
<dt>kwargs<span class="classifier">additional key word arguments, optional</span></dt><dd><p>any additional constraint argument to be passed.</p>
</dd>
</dl>
<p>returns the optimal weights, objective measure, value of the best optimization (out). automatically adds weights
to the portfolio_spec objects.</p>
<p>portfolio_spec
add_constraint
add_objective</p>
<dl class="simple">
<dt>currently suuported optimization methods are:</dt><dd><p>‘pso’
‘DEoptim’
‘dual_annealing’
‘brute’
‘shgo’
‘basinhopping’</p>
</dd>
</dl>
<p>The function calls constrained_objective to minimize the penalty (default = 10000) to come to a solution.
the purpose of adding different optimization method is to give flexibility to user to choose optimizer based on
specific problem.</p>
<p>Additional arguments can be specified such as maxiter, disp and other controls. the argument names are similar in
scipy.optimize.[optimizer] or pyswarms. see scipy and pyswarm documentation.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">port</span> <span class="o">=</span> <span class="n">portfolio_spec</span><span class="p">(</span><span class="n">assets</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas_datareader</span> <span class="k">as</span> <span class="nn">pdr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aapl</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;AAPL&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msft</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;MSFT&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tsla</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;TSLA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uber</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;UBER&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">amzn</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;AMZN&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">port</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;aapl&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">aapl</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">6</span><span class="p">],</span> <span class="s1">&#39;msft&#39;</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">msft</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">6</span><span class="p">],</span>
<span class="go">    &#39;tsla&#39;: pd.DataFrame.reset_index(tsla).iloc[:,6], &#39;uber&#39;:pd.DataFrame.reset_index(uber).iloc[:,6],</span>
<span class="go">    &#39;amzn&#39;: pd.DataFrame.reset_index(amzn).iloc[:,6]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">port_ret</span> <span class="o">=</span> <span class="n">port</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">R</span> <span class="o">=</span> <span class="n">port_ret</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="s1">&#39;long_only&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="s1">&#39;full_investment&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#adding objectives</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_objective</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;return&#39;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="mf">0.0018</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_objective</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;portfolio_risk&#39;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="mf">0.015</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_objective</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;risk_budget&#39;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;risk_budget&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_objective</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;weight_conc&#39;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;HHI&#39;</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="mf">0.11</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_objective</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;performance_metrics&#39;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;sharpe&#39;</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="mf">0.13</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># add a custom objective by first defining it.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">sortino_ratio</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">R</span><span class="p">):</span>
<span class="go">        #SOME CODE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_objective</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;performance_metrics&#39;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sortino&#39;</span><span class="p">:</span><span class="n">sortino_ratio</span><span class="p">},</span> <span class="n">target</span> <span class="o">=</span> <span class="mf">0.35</span><span class="p">)</span>
<span class="go">NOTE: The output of sortino_ratio or other custom function in objective must be a float.</span>
<span class="go">NOTE: you can also add other custom function in other kind of objective in similar methd.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">optimize_portfolio</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">optimize_method</span>  <span class="o">=</span> <span class="s1">&#39;DEoptim&#39;</span><span class="p">,</span> <span class="n">disp</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">search_size</span> <span class="o">=</span> <span class="mi">30000</span><span class="p">)</span>
<span class="go">NOTE: Yout can provide addional adguments based on solver. See the solver documentation for more information.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># we have used scipy.optimize for most of the solver and pyswarms for &#39;pso&#39; method.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">optimize_portfolio</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">optimize_method</span>  <span class="o">=</span> <span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">disp</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">maxiter</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">)</span>
<span class="go">NOTE: &#39;best&#39; optimize_method takes a while to give ouput because it uses all other optimizers.</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.performance_metrics_objective">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">performance_metrics_objective</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">arguments</span></em>, <em class="sig-param"><span class="n">target</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">multiplier</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">enabled</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.performance_metrics_objective" title="Permalink to this definition">¶</a></dt>
<dd><p>We’ll try minimizing the performance_metric if the target is null.    
Constructor for the portfolio_risk_objective class.</p>
<dl class="simple">
<dt>name<span class="classifier">str,</span></dt><dd><p>The target name should correspond to a feature, although we will attempt to make allowances</p>
</dd>
<dt>target<span class="classifier">float,</span></dt><dd><p>Univariate goal for the target.</p>
</dd>
<dt>arguments<span class="classifier">dict, optional</span></dt><dd><p>Default arguments to be transferred when executed on an objective function.</p>
</dd>
<dt>multiplier<span class="classifier">int, optional</span></dt><dd><p>Multiplier to be added to the target, typically 1 or -1.</p>
</dd>
<dt>enabled<span class="classifier">bool, default = True</span></dt><dd><p>bool to enable or disable constraints.</p>
</dd>
</dl>
<p>Adds portfolio risk objectives to object portfolio_spec of the specified input.</p>
<p>add_objectives
portfolio_risk_objectives
risk_budget_objective
turnover_objective
minmax_objective
weight_constraint_objective</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">port</span> <span class="o">=</span> <span class="n">portfolio_spec</span><span class="p">(</span><span class="n">assets</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas_datareader</span> <span class="k">as</span> <span class="nn">pdr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aapl</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;AAPL&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msft</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;MSFT&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tsla</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;TSLA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uber</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;UBER&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">amzn</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;AMZN&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">port</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;aapl&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">aapl</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">6</span><span class="p">],</span> <span class="s1">&#39;msft&#39;</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">msft</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">6</span><span class="p">],</span>
<span class="go">    &#39;tsla&#39;: pd.DataFrame.reset_index(tsla).iloc[:,6], &#39;uber&#39;:pd.DataFrame.reset_index(uber).iloc[:,6],</span>
<span class="go">    &#39;amzn&#39;: pd.DataFrame.reset_index(amzn).iloc[:,6]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">port_ret</span> <span class="o">=</span> <span class="n">port</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">R</span> <span class="o">=</span> <span class="n">port_ret</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="s1">&#39;long_only&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="s1">&#39;full_investment&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#adding objectives</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_objective</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;performance_metrics&#39;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;sharpe&#39;</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="mf">0.13</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># add a custom objective by first defining it.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">sortino_ratio</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">R</span><span class="p">):</span>
<span class="go">        #SOME CODE</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">add_objective</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;performance_metrics&#39;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sortino&#39;</span><span class="p">:</span><span class="n">sortino_ratio</span><span class="p">},</span> <span class="n">target</span> <span class="o">=</span> <span class="mf">0.35</span><span class="p">)</span>
<span class="go">NOTE: The output of sortino_ratio or other custom function in objective must be a float.</span>
<span class="go">NOTE: you can also add other custom function in other kind of objective in similar methd.</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.port_mean">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">port_mean</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">weights</span></em>, <em class="sig-param"><span class="n">mu</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.port_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a constraint in portfolio_spec object
Main function to add or update constraint in portfolio_spec object</p>
<dl class="simple">
<dt>weights<span class="classifier">array-like,</span></dt><dd><p>weights of the portfolio.</p>
</dd>
<dt>mu<span class="classifier">array-like,</span></dt><dd><p>mean return of assets</p>
</dd>
</dl>
<p>Adds port mean to object portfolio_spec of the specified input.</p>
<p>mu_{p} = w . mu_{r}</p>
<p>var_portfolio
VaR
cVaR</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1">#calculate the portfolio mean return</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.8</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">port_mean</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">R</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.portfolio_risk_objective">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">portfolio_risk_objective</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">target</span></em>, <em class="sig-param"><span class="n">arguments</span></em>, <em class="sig-param"><span class="n">multiplier</span><span class="o">=</span><span class="default_value">- 1</span></em>, <em class="sig-param"><span class="n">enabled</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.portfolio_risk_objective" title="Permalink to this definition">¶</a></dt>
<dd><p>We’ll try minimizing the risk metric if the target is null.    
Constructor for the portfolio_risk_objective class.</p>
<dl class="simple">
<dt>name<span class="classifier">str,</span></dt><dd><p>The target name should correspond to a feature, although we will attempt to make allowances</p>
</dd>
<dt>target<span class="classifier">float,</span></dt><dd><p>Univariate goal for the target.</p>
</dd>
<dt>arguments<span class="classifier">dict, optional</span></dt><dd><p>Default arguments to be transferred when executed on an objective function.</p>
</dd>
<dt>multiplier<span class="classifier">int, optional</span></dt><dd><p>Multiplier to be added to the target, typically 1 or -1.</p>
</dd>
<dt>enabled<span class="classifier">bool, default = True</span></dt><dd><p>bool to enable or disable constraints.</p>
</dd>
</dl>
<p>Adds portfolio risk objectives to object portfolio_spec of the specified input.</p>
<p>add_objectives
portfolio_risk_objectives
risk_budget_objective
turnover_objective
minmax_objective
weight_constraint_objective</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">port</span> <span class="o">=</span> <span class="n">portfolio_spec</span><span class="p">(</span><span class="n">assets</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas_datareader</span> <span class="k">as</span> <span class="nn">pdr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aapl</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;AAPL&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msft</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;MSFT&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tsla</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;TSLA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uber</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;UBER&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">amzn</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;AMZN&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">port</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;aapl&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">aapl</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">6</span><span class="p">],</span> <span class="s1">&#39;msft&#39;</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">msft</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">6</span><span class="p">],</span>
<span class="go">    &#39;tsla&#39;: pd.DataFrame.reset_index(tsla).iloc[:,6], &#39;uber&#39;:pd.DataFrame.reset_index(uber).iloc[:,6],</span>
<span class="go">    &#39;amzn&#39;: pd.DataFrame.reset_index(amzn).iloc[:,6]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">port_ret</span> <span class="o">=</span> <span class="n">port</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">R</span> <span class="o">=</span> <span class="n">port_ret</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="s1">&#39;long_only&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="s1">&#39;full_investment&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#adding objectives</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_objective</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;portfolio_risk&#39;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="mf">0.015</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># add a custom objective by first defining it.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">sortino_ratio</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">R</span><span class="p">):</span>
<span class="go">        #SOME CODE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_objective</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;performance_metrics&#39;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sortino&#39;</span><span class="p">:</span><span class="n">sortino_ratio</span><span class="p">},</span> <span class="n">target</span> <span class="o">=</span> <span class="mf">0.35</span><span class="p">)</span>
<span class="go">NOTE: The output of sortino_ratio or other custom function in objective must be a float.</span>
<span class="go">NOTE: you can also add other custom function in other kind of objective in similar methd.</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt id="pyPortfolioAnalysis.portfolio_spec">
<em class="property">class </em><code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">portfolio_spec</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">assets</span></em>, <em class="sig-param"><span class="n">category_labels</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">weights_seq</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">message</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.portfolio_spec" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class to call portfolio_spec object.</p>
<p>portfolio_spec object is the main class that contains all the constraints, objectives, optimal weights;
it is called by many functions to get relevant attributes and store attributes.</p>
<p>…</p>
<dl class="simple">
<dt>assets<span class="classifier">int, or array-like,</span></dt><dd><p>add assets to portfolio either via name of assets in the form of an array or int of number of assets.</p>
</dd>
<dt>category_label: dict, optional</dt><dd><p>dictionary of different categories assigned to different assets. similar to group_constraint.
See group_constraint.</p>
</dd>
<dt>weights_seq<span class="classifier">sequence, optional</span></dt><dd><p>sequence of random weights. These weights will be used to optimize weights. See generate_sequence</p>
</dd>
<dt>message<span class="classifier">bool, default = False</span></dt><dd><p>bool to enable or diable message</p>
</dd>
</dl>
<dl class="simple">
<dt>port_summary():</dt><dd><p>returns a dictionary of the summary of constraints and objective added by add_consraint and add_objective
funtions. See add_constraint, add_objective</p>
</dd>
<dt>optimal_portfolio():</dt><dd><p>returns a dictionary of optimal weights, objective measure and minimum value calculated by the specified solver
NOTE: optimal_portfolio will only return result if optimize_portfolio is called. See optimize_portfolio</p>
</dd>
</dl>
<dl class="py method">
<dt id="pyPortfolioAnalysis.portfolio_spec.optimal_portfolio">
<code class="sig-name descname">optimal_portfolio</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.portfolio_spec.optimal_portfolio" title="Permalink to this definition">¶</a></dt>
<dd><p>summary of the portfolio</p>
<p>method to provide a summary of the optimal weights, objective and minimum output of portfolio.</p>
<dl class="simple">
<dt>dict:</dt><dd><p>returns a dictionary of optimal weights, objective and minimum output of portfolio</p>
</dd>
</dl>
<p>portfolio_spec
optimize_portfolio</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas_datareader</span> <span class="k">as</span> <span class="nn">pdr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aapl</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;AAPL&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msft</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;MSFT&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tsla</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;TSLA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uber</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;UBER&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">amzn</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;AMZN&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">port</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;aapl&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">aapl</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">6</span><span class="p">],</span> <span class="s1">&#39;msft&#39;</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">msft</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">6</span><span class="p">],</span>
<span class="go">    &#39;tsla&#39;: pd.DataFrame.reset_index(tsla).iloc[:,6], &#39;uber&#39;:pd.DataFrame.reset_index(uber).iloc[:,6],</span>
<span class="go">    &#39;amzn&#39;: pd.DataFrame.reset_index(amzn).iloc[:,6]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">port_ret</span> <span class="o">=</span> <span class="n">port</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">R</span> <span class="o">=</span> <span class="n">port_ret</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="n">portfolio_spec</span><span class="p">(</span><span class="n">assets</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="n">portfolio</span> <span class="o">=</span> <span class="n">p1</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;factor_exposure&#39;</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.4</span><span class="p">],</span> <span class="n">lower</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">upper</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="n">portfolio</span> <span class="o">=</span> <span class="n">p1</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;group&#39;</span><span class="p">,</span> <span class="n">groups</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="s1">&#39;equity&#39;</span><span class="p">,</span><span class="s1">&#39;debt&#39;</span><span class="p">],[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">]])),</span> <span class="n">group_min</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">group_max</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="n">portfolio</span> <span class="o">=</span> <span class="n">p1</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;transaction&#39;</span><span class="p">,</span> <span class="n">ptc</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_objective</span><span class="p">(</span><span class="n">portfolio</span> <span class="o">=</span> <span class="n">p1</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;return&#39;</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;return_obj&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_objective</span><span class="p">(</span><span class="n">portfolio</span> <span class="o">=</span> <span class="n">p1</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;minmax&#39;</span><span class="p">,</span>  <span class="n">minimum</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">maximum</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;risk&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">optimize_portfolio</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">optimize_method</span> <span class="o">=</span> <span class="s1">&#39;DEoptim&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span><span class="o">.</span><span class="n">optimal_weights</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyPortfolioAnalysis.portfolio_spec.port_summary">
<code class="sig-name descname">port_summary</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.portfolio_spec.port_summary" title="Permalink to this definition">¶</a></dt>
<dd><p>summary of the portfolio</p>
<p>method to provide a summary of the portfolio.</p>
<dl class="simple">
<dt>dict:</dt><dd><p>returns a dictionary of all constraints and objective</p>
</dd>
</dl>
<p>portfolio_spec
optimize_portfolio</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas_datareader</span> <span class="k">as</span> <span class="nn">pdr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aapl</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;AAPL&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msft</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;MSFT&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tsla</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;TSLA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uber</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;UBER&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">amzn</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;AMZN&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">port</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;aapl&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">aapl</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">6</span><span class="p">],</span> <span class="s1">&#39;msft&#39;</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">msft</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">6</span><span class="p">],</span>
<span class="go">    &#39;tsla&#39;: pd.DataFrame.reset_index(tsla).iloc[:,6], &#39;uber&#39;:pd.DataFrame.reset_index(uber).iloc[:,6],</span>
<span class="go">    &#39;amzn&#39;: pd.DataFrame.reset_index(amzn).iloc[:,6]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">port_ret</span> <span class="o">=</span> <span class="n">port</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">R</span> <span class="o">=</span> <span class="n">port_ret</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="n">portfolio_spec</span><span class="p">(</span><span class="n">assets</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="n">portfolio</span> <span class="o">=</span> <span class="n">p1</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;factor_exposure&#39;</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.4</span><span class="p">],</span> <span class="n">lower</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">upper</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="n">portfolio</span> <span class="o">=</span> <span class="n">p1</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;group&#39;</span><span class="p">,</span> <span class="n">groups</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="s1">&#39;equity&#39;</span><span class="p">,</span><span class="s1">&#39;debt&#39;</span><span class="p">],[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">]])),</span> <span class="n">group_min</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">group_max</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="n">portfolio</span> <span class="o">=</span> <span class="n">p1</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;transaction&#39;</span><span class="p">,</span> <span class="n">ptc</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_objective</span><span class="p">(</span><span class="n">portfolio</span> <span class="o">=</span> <span class="n">p1</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;return&#39;</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;return_obj&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_objective</span><span class="p">(</span><span class="n">portfolio</span> <span class="o">=</span> <span class="n">p1</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;minmax&#39;</span><span class="p">,</span>  <span class="n">minimum</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">maximum</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;risk&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span><span class="o">.</span><span class="n">port_summary</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.pos_limit_fail">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">pos_limit_fail</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">weights</span></em>, <em class="sig-param"><span class="n">max_pos</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_pos_long</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_pos_short</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.pos_limit_fail" title="Permalink to this definition">¶</a></dt>
<dd><p>This is used as a rp_transform helper function to search for position limit constraints being violated.</p>
<dl class="simple">
<dt>weights<span class="classifier">array-like,</span></dt><dd><p>test list of weights.</p>
</dd>
<dt>max_pos<span class="classifier">int, optional</span></dt><dd><p>maximum number of non-zero-weighted assets</p>
</dd>
<dt>max_pos_long<span class="classifier">int, optional</span></dt><dd><p>maximum number of long-position assets</p>
</dd>
<dt>max_pos_short<span class="classifier">int, optional</span></dt><dd><p>maximum number of short-position assets</p>
</dd>
</dl>
<p>Returns “True” if the weights fail the pos_limit constraint. called by rp_transform. see rp_transform.</p>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.position_limit_constraint">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">position_limit_constraint</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">assets</span></em>, <em class="sig-param"><span class="n">max_pos</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">kind</span><span class="o">=</span><span class="default_value">'position'</span></em>, <em class="sig-param"><span class="n">max_pos_long</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_pos_short</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">enabled</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">message</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.position_limit_constraint" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>When type=”position_limit” is mentioned, this function is called by add.constraint.</p>
<p>The maximum number of positions as well as the maximum number of long and short positions
are determined by the user using this function.</p>
<dl class="simple">
<dt>assets<span class="classifier">int, or array-like,</span></dt><dd><p>named list of assets determining initial weights.</p>
</dd>
<dt>max_pos<span class="classifier">int,</span></dt><dd><p>maximum number of assets with non-zero weights.</p>
</dd>
<dt>kind<span class="classifier">str,</span></dt><dd><p>string of kind of constraint</p>
</dd>
<dt>max_pos_long<span class="classifier">Int, optional</span></dt><dd><p>maximum number of assets with long positions.</p>
</dd>
<dt>max_pos_short<span class="classifier">Int, optional</span></dt><dd><p>maximum number of assets with short positions.</p>
</dd>
<dt>enabled<span class="classifier">bool, default = True</span></dt><dd><p>bool to enable or disable constraints.</p>
</dd>
<dt>message<span class="classifier">bool, default = True</span></dt><dd><p>bool to enable or disable messages.</p>
</dd>
</dl>
<p>Adds position_limit constraints to object portfolio_spec of the specified input.</p>
<p>add_constraints
box_constraints
group_constraints
weight_sum_constraint
turnover_constraint
diversification_constraint
position_limit_constraint
return_constraint
factor_exposure_constraint
transaction_cost_constraint
leverage_exposure_constraint</p>
</div></blockquote>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1">#position_limit is a constraint to restrict max position and also max long/short positions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="n">portfolio</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;position_limit&#39;</span><span class="p">,</span> <span class="n">max_pos</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">max_pos_long</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">max_pos_short</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.return_constraint">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">return_constraint</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">assets</span></em>, <em class="sig-param"><span class="n">return_target</span></em>, <em class="sig-param"><span class="n">kind</span><span class="o">=</span><span class="default_value">'return'</span></em>, <em class="sig-param"><span class="n">enabled</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">message</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.return_constraint" title="Permalink to this definition">¶</a></dt>
<dd><p>Target mean return value is determined by the return constraint. 
When type=”return” is mentioned, this function is called by add_constraint.</p>
<dl class="simple">
<dt>assets :. int, or array-like,</dt><dd><p>named list of assets determining initial weights.</p>
</dd>
<dt>kind<span class="classifier">str,</span></dt><dd><p>string of kind of constraints.</p>
</dd>
<dt>enabled<span class="classifier">bool, default = True</span></dt><dd><p>bool to enable or disable constraints.</p>
</dd>
<dt>messages<span class="classifier">bool, default = False</span></dt><dd><p>bool to enable or disable messages.</p>
</dd>
</dl>
<p>Adds return constraints to object portfolio_spec of the specified input.</p>
<p>add_constraints
box_constraints
group_constraints
weight_sum_constraint
turnover_constraint
diversification_constraint
position_limit_constraint
return_constraint
factor_exposure_constraint
transaction_cost_constraint
leverage_exposure_constraint</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1">#return constraint to add a target mean historical return to the portfolio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="n">portfolio</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;return&#39;</span><span class="p">,</span> <span class="n">return_target</span> <span class="o">=</span> <span class="mf">0.0018</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.return_objective">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">return_objective</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">target</span></em>, <em class="sig-param"><span class="n">arguments</span></em>, <em class="sig-param"><span class="n">multiplier</span><span class="o">=</span><span class="default_value">- 1</span></em>, <em class="sig-param"><span class="n">enabled</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.return_objective" title="Permalink to this definition">¶</a></dt>
<dd><p>We’ll try minimizing the risk metric if the target is null.    
Constructor for the portfolio_risk_objective class.</p>
<dl class="simple">
<dt>name<span class="classifier">str,</span></dt><dd><p>The target name should correspond to a feature, although we will attempt to make allowances</p>
</dd>
<dt>target<span class="classifier">float,</span></dt><dd><p>Univariate goal for the target.</p>
</dd>
<dt>arguments<span class="classifier">dict, optional</span></dt><dd><p>Default arguments to be transferred when executed on an objective function.</p>
</dd>
<dt>multiplier<span class="classifier">int, optional</span></dt><dd><p>Multiplier to be added to the target, typically 1 or -1.</p>
</dd>
<dt>enabled<span class="classifier">bool, default = True</span></dt><dd><p>bool to enable or disable constraints.</p>
</dd>
</dl>
<p>Adds return_objective to object portfolio_spec of the specified input.</p>
<p>add_objectives
portfolio_risk_objectives
risk_budget_objective
turnover_objective
minmax_objective
weight_constraint_objective</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">port</span> <span class="o">=</span> <span class="n">portfolio_spec</span><span class="p">(</span><span class="n">assets</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas_datareader</span> <span class="k">as</span> <span class="nn">pdr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aapl</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;AAPL&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msft</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;MSFT&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tsla</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;TSLA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uber</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;UBER&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">amzn</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;AMZN&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">port</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;aapl&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">aapl</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">6</span><span class="p">],</span> <span class="s1">&#39;msft&#39;</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">msft</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">6</span><span class="p">],</span>
<span class="go">    &#39;tsla&#39;: pd.DataFrame.reset_index(tsla).iloc[:,6], &#39;uber&#39;:pd.DataFrame.reset_index(uber).iloc[:,6],</span>
<span class="go">    &#39;amzn&#39;: pd.DataFrame.reset_index(amzn).iloc[:,6]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">port_ret</span> <span class="o">=</span> <span class="n">port</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">R</span> <span class="o">=</span> <span class="n">port_ret</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="s1">&#39;long_only&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="s1">&#39;full_investment&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#adding objectives</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_objective</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;return&#39;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="mf">0.0018</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># add a custom objective by first defining it.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">sortino_ratio</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">R</span><span class="p">):</span>
<span class="go">        #SOME CODE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_objective</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;performance_metrics&#39;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sortino&#39;</span><span class="p">:</span><span class="n">sortino_ratio</span><span class="p">},</span> <span class="n">target</span> <span class="o">=</span> <span class="mf">0.35</span><span class="p">)</span>
<span class="go">NOTE: The output of sortino_ratio or other custom function in objective must be a float.</span>
<span class="go">NOTE: you can also add other custom function in other kind of objective in similar methd.</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.risk_budget_objective">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">risk_budget_objective</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">assets</span></em>, <em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">min_prisk</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_prisk</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">target</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">arguments</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">multiplier</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">enabled</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">min_concentration</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">min_difference</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.risk_budget_objective" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Constructor for the risk_budget_objective.</p>
<dl class="simple">
<dt>assets<span class="classifier">int, or array-like,</span></dt><dd><p>The asset list to be used should come from object constraints.</p>
</dd>
<dt>name<span class="classifier">str,</span></dt><dd><p>The target name should correspond to a feature, although we will attempt to make allowances.</p>
</dd>
<dt>min_prisk<span class="classifier">float,</span></dt><dd><p>minimum percentage risk contribution</p>
</dd>
<dt>max_prisk<span class="classifier">float,</span></dt><dd><p>maximum percentage risk contribution</p>
</dd>
<dt>arguments<span class="classifier">dict, optional</span></dt><dd><p>Default arguments to be transferred when executed on an objective function.</p>
</dd>
<dt>multiplier<span class="classifier">int, optional</span></dt><dd><p>Multiplier to be added to the target, typically 1 or -1.</p>
</dd>
</dl>
<p>Adds risk budget objective to object portfolio_spec of the specified input.</p>
<p>add_objectives
portfolio_risk_objectives
risk_budget_objective
turnover_objective
minmax_objective
weight_constraint_objective</p>
</div></blockquote>
<dl>
<dt>Examples</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">port</span> <span class="o">=</span> <span class="n">portfolio_spec</span><span class="p">(</span><span class="n">assets</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas_datareader</span> <span class="k">as</span> <span class="nn">pdr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aapl</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;AAPL&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msft</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;MSFT&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tsla</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;TSLA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uber</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;UBER&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">amzn</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;AMZN&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">port</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;aapl&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">aapl</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">6</span><span class="p">],</span> <span class="s1">&#39;msft&#39;</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">msft</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">6</span><span class="p">],</span>
<span class="go">    &#39;tsla&#39;: pd.DataFrame.reset_index(tsla).iloc[:,6], &#39;uber&#39;:pd.DataFrame.reset_index(uber).iloc[:,6],</span>
<span class="go">    &#39;amzn&#39;: pd.DataFrame.reset_index(amzn).iloc[:,6]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">port_ret</span> <span class="o">=</span> <span class="n">port</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">R</span> <span class="o">=</span> <span class="n">port_ret</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="s1">&#39;long_only&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="s1">&#39;full_investment&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#adding objectives</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_objective</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;risk_budget&#39;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;risk_budget&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_objective</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;weight_conc&#39;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;HHI&#39;</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="mf">0.11</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_objective</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;performance_metrics&#39;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;sharpe&#39;</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="mf">0.13</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># add a custom objective by first defining it.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">sortino_ratio</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">R</span><span class="p">):</span>
<span class="go">        #SOME CODE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_objective</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;performance_metrics&#39;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sortino&#39;</span><span class="p">:</span><span class="n">sortino_ratio</span><span class="p">},</span> <span class="n">target</span> <span class="o">=</span> <span class="mf">0.35</span><span class="p">)</span>
<span class="go">NOTE: The output of sortino_ratio or other custom function in objective must be a float.</span>
<span class="go">NOTE: you can also add other custom function in other kind of objective in similar methd.</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.rp_decrease">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">rp_decrease</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">weights</span></em>, <em class="sig-param"><span class="n">max_sum</span></em>, <em class="sig-param"><span class="n">min_box</span></em>, <em class="sig-param"><span class="n">weight_seq</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.rp_decrease" title="Permalink to this definition">¶</a></dt>
<dd><p>It is used by rp_transform as a helper function to reduce weights if 
max_sum or min_box constraint is breached.</p>
<dl class="simple">
<dt>weights<span class="classifier">array-like,</span></dt><dd><p>test of list of weights</p>
</dd>
<dt>max_sum<span class="classifier">float,</span></dt><dd><p>maximum sum of weights</p>
</dd>
<dt>min_box<span class="classifier">array-like,</span></dt><dd><p>minimum of individual weights in a portfolio</p>
</dd>
<dt>weight_seq<span class="classifier">seq,</span></dt><dd><p>sequence of random weights to choose from</p>
</dd>
</dl>
<p>returns an array of weights that satisfy the max_sum and min_box constraint. called by rp_transform.</p>
<p>rp_increase
rp_transform</p>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.rp_decrease_leverage">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">rp_decrease_leverage</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">weights</span></em>, <em class="sig-param"><span class="n">max_box</span></em>, <em class="sig-param"><span class="n">min_box</span></em>, <em class="sig-param"><span class="n">leverage</span></em>, <em class="sig-param"><span class="n">weight_seq</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.rp_decrease_leverage" title="Permalink to this definition">¶</a></dt>
<dd><p>It is used by rp_transform as a helper function to redcrese leverage if 
leverage_exposure constraint is breached.</p>
<dl class="simple">
<dt>weights<span class="classifier">array-like,</span></dt><dd><p>test of list of weights</p>
</dd>
<dt>max_box<span class="classifier">array-like,</span></dt><dd><p>maximum of individual weights in a portfolio</p>
</dd>
<dt>min_box<span class="classifier">like,</span></dt><dd><p>minimum of individual weights in a portfolio</p>
</dd>
<dt>leverage: float,</dt><dd><p>leverage as specified in leverage_exposure constraints</p>
</dd>
<dt>weight_seq<span class="classifier">seq,</span></dt><dd><p>sequence of random weights to choose from</p>
</dd>
</dl>
<p>returns an array of weights that satisfy the leverage constraint. called by rp_transform.</p>
<p>rp_increase
rp_transform</p>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.rp_increase">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">rp_increase</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">weights</span></em>, <em class="sig-param"><span class="n">min_sum</span></em>, <em class="sig-param"><span class="n">max_box</span></em>, <em class="sig-param"><span class="n">weight_seq</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.rp_increase" title="Permalink to this definition">¶</a></dt>
<dd><p>It is used by rp_transform as a helper function to increase weights if 
min_sum or max_box constraint is breached.</p>
<dl class="simple">
<dt>weights<span class="classifier">array-like,</span></dt><dd><p>test of list of weights</p>
</dd>
<dt>max_sum<span class="classifier">float,</span></dt><dd><p>maximum sum of weights</p>
</dd>
<dt>min_box<span class="classifier">float,</span></dt><dd><p>minimum of individual weights in a portfolio</p>
</dd>
<dt>weight_seq<span class="classifier">seq,</span></dt><dd><p>sequence of random weights to choose from</p>
</dd>
</dl>
<p>returns an array of weights that satisfy the max_sum and min_box constraint. called by rp_transform.</p>
<p>rp_increase
rp_transform</p>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.rp_position_limit">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">rp_position_limit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">weights</span></em>, <em class="sig-param"><span class="n">min_box</span></em>, <em class="sig-param"><span class="n">max_box</span></em>, <em class="sig-param"><span class="n">weight_seq</span></em>, <em class="sig-param"><span class="n">max_pos</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_pos_long</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_pos_short</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.rp_position_limit" title="Permalink to this definition">¶</a></dt>
<dd><p>It is used by rp_transform as a helper function to increase weights if 
position_limit constraint is breached.</p>
<dl class="simple">
<dt>weights<span class="classifier">array-like,</span></dt><dd><p>test of list of weights</p>
</dd>
<dt>min_box<span class="classifier">array-like,</span></dt><dd><p>maximum of individual weights in a portfolio</p>
</dd>
<dt>min_box<span class="classifier">array-like,</span></dt><dd><p>minimum of individual weights in a portfolio</p>
</dd>
<dt>max_pos<span class="classifier">int, optional</span></dt><dd><p>maximum position to hold in a portfolio</p>
</dd>
<dt>max_pos_long<span class="classifier">int, optional</span></dt><dd><p>maximum long position to hold in a portfolio</p>
</dd>
<dt>max_pos_short<span class="classifier">int, optional</span></dt><dd><p>maximum short position to hold in a portfolio</p>
</dd>
<dt>weight_seq<span class="classifier">seq,</span></dt><dd><p>sequence of random weights to choose from</p>
</dd>
</dl>
<p>returns an array of weights that satisfy the position limit constraint. called by rp_transform.</p>
<p>rp_increase
rp_transform
rp_decrease_leverage</p>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.rp_transform">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">rp_transform</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">w</span></em>, <em class="sig-param"><span class="n">min_sum</span></em>, <em class="sig-param"><span class="n">max_sum</span></em>, <em class="sig-param"><span class="n">min_box</span></em>, <em class="sig-param"><span class="n">max_box</span></em>, <em class="sig-param"><span class="n">groups</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cLO</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cUP</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">group_pos</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_pos</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_pos_long</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_pos_short</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">leverage</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">weight_seq</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_permutations</span><span class="o">=</span><span class="default_value">2000</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.rp_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>This function is mainly used to transform weights that dont satisfy the constraints such as:
“box”
“group”
“max_pos”
“leverage_exposure”
See add_constraint for more deatils.</p>
<p>Transform a list of weights to fulfill constraints</p>
<dl class="simple">
<dt>weights<span class="classifier">array-like,</span></dt><dd><p>list of weights to be transformed</p>
</dd>
<dt>min_sum<span class="classifier">float,</span></dt><dd><p>minimum total of all weights of assets, default of 0.99</p>
</dd>
<dt>max_sum<span class="classifier">float,</span></dt><dd><p>maximum total of all weights of assets, default of 1.01</p>
</dd>
<dt>min_box<span class="classifier">array-like,</span></dt><dd><p>numeric or called list defining the minimum constraints of the weight box</p>
</dd>
<dt>max_box<span class="classifier">array-like</span></dt><dd><p>numeric or called list defining the maximum constraints of the weight box</p>
</dd>
<dt>groups<span class="classifier">dict, </span></dt><dd><p>a dictionary defining the asset groups. similar to group_constraint. see group_constraint</p>
</dd>
<dt>cLO<span class="classifier">flaot, or array-like,</span></dt><dd><p>float or list defining the minimum constraints of the weight group</p>
</dd>
<dt>cUP<span class="classifier">float, or array-like</span></dt><dd><p>float or list defining the minimum constraints of the weight group</p>
</dd>
<dt>group_pos<span class="classifier">array-like, optional</span></dt><dd><p>list that specifies the maximum number of non-zero-weight assets per group</p>
</dd>
<dt>max_pos<span class="classifier">int,</span></dt><dd><p>maximum non-zero-weight assets</p>
</dd>
<dt>max_pos_long<span class="classifier">int</span></dt><dd><p>maximum number of long (i. e. buy) position assets</p>
</dd>
<dt>max_pos_short<span class="classifier">int,</span></dt><dd><p>maximum number of short (i. e. sell) position assets</p>
</dd>
<dt>leverage<span class="classifier">float,</span></dt><dd><p>maximum exposure to leverage in which leverage is defined as sum(abs(weights))</p>
</dd>
<dt>weight_seq<span class="classifier">seq, optional</span></dt><dd><p>list of seed sequence of weights. uses generate_sequence()</p>
</dd>
<dt>max_permutations<span class="classifier">int, optional</span></dt><dd><p>integer- maximum number of iterations to try for a portfolio which is valid, default 2000</p>
</dd>
</dl>
<p>weights array that satisfy the constraints on portfolio</p>
<p>rp_increase
rp_decrease
fn_map</p>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.transaction_cost_constraint">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">transaction_cost_constraint</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">assets</span></em>, <em class="sig-param"><span class="n">ptc</span></em>, <em class="sig-param"><span class="n">kind</span><span class="o">=</span><span class="default_value">'transaction'</span></em>, <em class="sig-param"><span class="n">enabled</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">message</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.transaction_cost_constraint" title="Permalink to this definition">¶</a></dt>
<dd><p>A proportional cost value is determined under the transaction cost constraint.
When type=”transaction_cost” is specified, this function is called by add.constraint.</p>
<dl class="simple">
<dt>assets<span class="classifier">int, or array-like,</span></dt><dd><p>number of assets, or optionally a named list of assets determining initial weights.</p>
</dd>
<dt>ptc<span class="classifier">float,</span></dt><dd><p>proportional transaction cost value.</p>
</dd>
<dt>kind<span class="classifier">str,</span></dt><dd><p>string of kind of constraint</p>
</dd>
<dt>enabled<span class="classifier">bool, default = True</span></dt><dd><p>bool to enable or disable constraints.</p>
</dd>
<dt>message<span class="classifier">bool, default = True</span></dt><dd><p>bool to enable or disable messages.</p>
</dd>
</dl>
<p>Adds transaction _cost constraints to object portfolio_spec of the specified input.</p>
<p>add_constraints
box_constraints
group_constraints
weight_sum_constraint
turnover_constraint
diversification_constraint
position_limit_constraint
return_constraint
factor_exposure_constraint
transaction_cost_constraint
leverage_exposure_constraint</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1">#adds a tranaction cost constraint on portfolio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="n">portfolio</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;transaction_cost&#39;</span><span class="p">,</span> <span class="n">ptc</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.turnover">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">turnover</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">weights</span></em>, <em class="sig-param"><span class="n">wgt_init</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.turnover" title="Permalink to this definition">¶</a></dt>
<dd><p>Turnover estimation of two weight lists.
This is used as an objective function and is named when the user adds with add.objective 
an objective of type turnover.</p>
<dl class="simple">
<dt>weights<span class="classifier">array-like,</span></dt><dd><p>Weights list from optimization.</p>
</dd>
<dt>wgt_init<span class="classifier">array-like, optional</span></dt><dd><p>Initial weights list used for measuring turnover from.</p>
</dd>
</dl>
<p>returns the turnover of the portfolio given the weights</p>
<p>var_portfolio
port_mean</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">port</span> <span class="o">=</span> <span class="n">portfolio_spec</span><span class="p">(</span><span class="n">assets</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas_datareader</span> <span class="k">as</span> <span class="nn">pdr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aapl</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;AAPL&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msft</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;MSFT&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tsla</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;TSLA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uber</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;UBER&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">amzn</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;AMZN&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">port</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;aapl&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">aapl</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">6</span><span class="p">],</span> <span class="s1">&#39;msft&#39;</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">msft</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">6</span><span class="p">],</span>
<span class="go">    &#39;tsla&#39;: pd.DataFrame.reset_index(tsla).iloc[:,6], &#39;uber&#39;:pd.DataFrame.reset_index(uber).iloc[:,6],</span>
<span class="go">    &#39;amzn&#39;: pd.DataFrame.reset_index(amzn).iloc[:,6]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">port_ret</span> <span class="o">=</span> <span class="n">port</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">R</span> <span class="o">=</span> <span class="n">port_ret</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="o">-.</span><span class="mi">4</span><span class="p">,</span><span class="mf">0.5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">turnover</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.turnover_constraint">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">turnover_constraint</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">assets</span></em>, <em class="sig-param"><span class="n">turnover_target</span></em>, <em class="sig-param"><span class="n">kind</span><span class="o">=</span><span class="default_value">'turnover'</span></em>, <em class="sig-param"><span class="n">enabled</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">message</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.turnover_constraint" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Target turnover value is determined under the turnover constraint. 
When type=”turnover” is stated, the function is called by add.constraint</p>
<dl class="simple">
<dt>asset<span class="classifier">Int, or array-like,</span></dt><dd><p>Number of assets or, as an alternative, a named asset list specifying initial weights.</p>
</dd>
<dt>kind<span class="classifier">str,</span></dt><dd><p>character kind of the constraint.</p>
</dd>
<dt>enabled<span class="classifier">bool, default = True</span></dt><dd><p>bool to enable or disable constraints.</p>
</dd>
<dt>message<span class="classifier">bool, default = True</span></dt><dd><p>bool to enable or disable messages.</p>
</dd>
</dl>
<p>Adds  turnover constraints to object portfolio_spec of the specified input.</p>
<p>add_constraints
box_constraints
group_constraints
weight_sum_constraint
turnover_constraint
diversification_constraint
position_limit_constraint
return_constraint
factor_exposure_constraint
transaction_cost_constraint
leverage_exposure_constraint</p>
</div></blockquote>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1">#turnover constraint</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="n">portfolio</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;turnover&#39;</span><span class="p">,</span> <span class="n">turnover_target</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.turnover_objective">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">turnover_objective</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">arguments</span></em>, <em class="sig-param"><span class="n">target</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">multiplier</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">enabled</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.turnover_objective" title="Permalink to this definition">¶</a></dt>
<dd><p>We’ll try minimizing the turnover metric if the goal is null.    
Constructor for the turnover_objective class.</p>
<dl class="simple">
<dt>name<span class="classifier">str,</span></dt><dd><p>The target name should correspond to a feature, although we will attempt to make allowances.</p>
</dd>
<dt>arguments<span class="classifier">dict,</span></dt><dd><p>Default arguments to be transferred when executed on an objective function.</p>
</dd>
<dt>target<span class="classifier">float,</span></dt><dd><p>Univariate goal for the target.</p>
</dd>
<dt>multiplier<span class="classifier">int, optional</span></dt><dd><p>Multiplier to be added to the target, typically 1 or -1.</p>
</dd>
<dt>enabled<span class="classifier">bool, default = True</span></dt><dd><p>bool to enable or disable constraints.</p>
</dd>
</dl>
<p>Adds turnover_objective to object portfolio_spec of the specified input.</p>
<p>add_objectives
portfolio_risk_objectives
risk_budget_objective
turnover_objective
minmax_objective
weight_constraint_objective</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">port</span> <span class="o">=</span> <span class="n">portfolio_spec</span><span class="p">(</span><span class="n">assets</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas_datareader</span> <span class="k">as</span> <span class="nn">pdr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aapl</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;AAPL&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msft</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;MSFT&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tsla</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;TSLA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uber</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;UBER&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">amzn</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;AMZN&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">port</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;aapl&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">aapl</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">6</span><span class="p">],</span> <span class="s1">&#39;msft&#39;</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">msft</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">6</span><span class="p">],</span>
<span class="go">    &#39;tsla&#39;: pd.DataFrame.reset_index(tsla).iloc[:,6], &#39;uber&#39;:pd.DataFrame.reset_index(uber).iloc[:,6],</span>
<span class="go">    &#39;amzn&#39;: pd.DataFrame.reset_index(amzn).iloc[:,6]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">port_ret</span> <span class="o">=</span> <span class="n">port</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">R</span> <span class="o">=</span> <span class="n">port_ret</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="s1">&#39;long_only&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="s1">&#39;full_investment&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#adding objectives</span>
<span class="gp">&gt;&gt;&gt; </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_objective</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;turnover&#39;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;turnover&#39;</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_objective</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;performance_metrics&#39;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;sharpe&#39;</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="mf">0.13</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># add a custom objective by first defining it.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">sortino_ratio</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">R</span><span class="p">):</span>
<span class="go">        #SOME CODE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_objective</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;performance_metrics&#39;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sortino&#39;</span><span class="p">:</span><span class="n">sortino_ratio</span><span class="p">},</span> <span class="n">target</span> <span class="o">=</span> <span class="mf">0.35</span><span class="p">)</span>
<span class="go">NOTE: The output of sortino_ratio or other custom function in objective must be a float.</span>
<span class="go">NOTE: you can also add other custom function in other kind of objective in similar methd.</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.var_portfolio">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">var_portfolio</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">R</span></em>, <em class="sig-param"><span class="n">weights</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.var_portfolio" title="Permalink to this definition">¶</a></dt>
<dd><p>When var is an object for mean variance or quadratic utility optimization,
this function is used to measure the portfolio variance through a call to constrained_objective.</p>
<p>Main function to calculate portfolio variance</p>
<dl class="simple">
<dt>R<span class="classifier">pd.DataFrame,</span></dt><dd><p>return series</p>
</dd>
<dt>weights: array-like,</dt><dd><p>list of weights of assets.</p>
</dd>
</dl>
<p>returns the variance of the portfolio given the following weights.</p>
<p>sigma_{p} = w Sigma_{p} w^{T}</p>
<p>port_mean
VaR
cVaR</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># calculate the variance of portfolio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas_datareader</span> <span class="k">as</span> <span class="nn">pdr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aapl</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;AAPL&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msft</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;MSFT&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tsla</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;TSLA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uber</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;UBER&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">amzn</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;AMZN&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">port</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;aapl&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">aapl</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">6</span><span class="p">],</span> <span class="s1">&#39;msft&#39;</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">msft</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">6</span><span class="p">],</span>
<span class="go">    &#39;tsla&#39;: pd.DataFrame.reset_index(tsla).iloc[:,6], &#39;uber&#39;:pd.DataFrame.reset_index(uber).iloc[:,6],</span>
<span class="go">    &#39;amzn&#39;: pd.DataFrame.reset_index(amzn).iloc[:,6]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">port_ret</span> <span class="o">=</span> <span class="n">port</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">R</span> <span class="o">=</span> <span class="n">port_ret</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.8</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var_portfolio</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">R</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.weight_concentration_objective">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">weight_concentration_objective</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">conc_aversion</span></em>, <em class="sig-param"><span class="n">conc_groups</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">multiplier</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">arguments</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">enabled</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.weight_concentration_objective" title="Permalink to this definition">¶</a></dt>
<dd><p>Using the HHI as a concentration scale, this feature penalizes weight concentration
Constructor for objective of weight concentration.</p>
<dl class="simple">
<dt>name<span class="classifier">str,</span></dt><dd><p>The name of the concentration measure is currently only supported by “HHI”.</p>
</dd>
<dt>conc_aversion<span class="classifier">float,</span></dt><dd><p>concentration value(s) of aversion</p>
</dd>
<dt>conc_groups<span class="classifier">dict,</span></dt><dd><p>A dictionary defining the asset classes. Similar to ‘group constraint’ groups.</p>
</dd>
<dt>multiplier<span class="classifier">int, optional</span></dt><dd><p>Multiplier to be added to the target, typically 1 or -1.</p>
</dd>
<dt>arguments<span class="classifier">dict, optional</span></dt><dd><p>Default arguments to be transferred when executed on an objective function.</p>
</dd>
<dt>enabled<span class="classifier">bool, default = True</span></dt><dd><p>bool to enable or disable constraints.</p>
</dd>
</dl>
<p>Adds weight constraints objective to object portfolio_spec of the specified input.</p>
<p>add_objectives
portfolio_risk_objectives
risk_budget_objective
turnover_objective
minmax_objective
weight_constraint_objective</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">port</span> <span class="o">=</span> <span class="n">portfolio_spec</span><span class="p">(</span><span class="n">assets</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas_datareader</span> <span class="k">as</span> <span class="nn">pdr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aapl</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;AAPL&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msft</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;MSFT&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tsla</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;TSLA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uber</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;UBER&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">amzn</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_yahoo</span><span class="p">(</span><span class="s1">&#39;AMZN&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">port</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;aapl&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">aapl</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">6</span><span class="p">],</span> <span class="s1">&#39;msft&#39;</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">msft</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">6</span><span class="p">],</span>
<span class="go">    &#39;tsla&#39;: pd.DataFrame.reset_index(tsla).iloc[:,6], &#39;uber&#39;:pd.DataFrame.reset_index(uber).iloc[:,6],</span>
<span class="go">    &#39;amzn&#39;: pd.DataFrame.reset_index(amzn).iloc[:,6]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">port_ret</span> <span class="o">=</span> <span class="n">port</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">R</span> <span class="o">=</span> <span class="n">port_ret</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="s1">&#39;long_only&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="s1">&#39;full_investment&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_objective</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;weight_conc&#39;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;HHI&#39;</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="mf">0.11</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_objective</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;performance_metrics&#39;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;sharpe&#39;</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="mf">0.13</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># add a custom objective by first defining it.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">sortino_ratio</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">R</span><span class="p">):</span>
<span class="go">        #SOME CODE</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">add_objective</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;performance_metrics&#39;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sortino&#39;</span><span class="p">:</span><span class="n">sortino_ratio</span><span class="p">},</span> <span class="n">target</span> <span class="o">=</span> <span class="mf">0.35</span><span class="p">)</span>
<span class="go">NOTE: The output of sortino_ratio or other custom function in objective must be a float.</span>
<span class="go">NOTE: you can also add other custom function in other kind of objective in similar methd.</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyPortfolioAnalysis.weight_sum_constraint">
<code class="sig-prename descclassname">pyPortfolioAnalysis.</code><code class="sig-name descname">weight_sum_constraint</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">assets</span></em>, <em class="sig-param"><span class="n">kind</span><span class="o">=</span><span class="default_value">'weight_sum'</span></em>, <em class="sig-param"><span class="n">min_sum</span><span class="o">=</span><span class="default_value">0.99</span></em>, <em class="sig-param"><span class="n">max_sum</span><span class="o">=</span><span class="default_value">1.01</span></em>, <em class="sig-param"><span class="n">enabled</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">message</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyPortfolioAnalysis.weight_sum_constraint" title="Permalink to this definition">¶</a></dt>
<dd><p>The constraint determines the sum of the weights of the upper and lower limits.
This function is called add.constraint when the type is defined as “weight sum”, 
“leverage”, “full investment”, “dollar neutral” or “active”</p>
<dl class="simple">
<dt>assets<span class="classifier">Int, or array-like,</span></dt><dd><p>Number of assets or, as an alternative, a named asset list specifying initial weights.</p>
</dd>
<dt>kind<span class="classifier">str,</span></dt><dd><p>character kind of the constraint.</p>
</dd>
<dt>min_sum<span class="classifier">float,</span></dt><dd><p>Minimum sum of all weights of assets, default 0.99</p>
</dd>
<dt>max_sum<span class="classifier">float, </span></dt><dd><p>Maximum sum of all weights of assets, default 1.01</p>
</dd>
<dt>enabled<span class="classifier">bool, default = True</span></dt><dd><p>bool to enable or disable constraints.</p>
</dd>
<dt>message<span class="classifier">bool, default = True</span></dt><dd><p>bool to enable or disable messages.</p>
</dd>
</dl>
<p>Adds weight_sum constraint to object portfolio_spec of the specified input.</p>
<p>add_constraints
box_constraints
group_constraints
weight_sum_constraint
turnover_constraint
diversification_constraint
position_limit_constraint
return_constraint
factor_exposure_constraint
transaction_cost_constraint
leverage_exposure_constraint</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># adding weight_sum constraint</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="n">portfolio</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;weight_sum&#39;</span><span class="p">,</span> <span class="n">min_sum</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n">max_sum</span> <span class="o">=</span> <span class="o">.</span><span class="mi">95</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># special case of weight_sum is dollar_neutral/active or full_investment</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="n">portfolio</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;dollar_neutral&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_constraint</span><span class="p">(</span><span class="n">portfolio</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;full_investment&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="modules.html" class="btn btn-neutral float-left" title="pyPortfolioAnalysis" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Anurag Agrawal.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>